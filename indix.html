<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8"/>
      <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
      <meta content="The ultimate suite of 27 free, secure online PDF tools with AI support. Convert, merge, split, compress, and edit PDF files with detailed guides. No uploads required." name="description"/>
      <meta content="pdf tools, free pdf editor, online pdf tools, merge pdf, split pdf, compress pdf, convert pdf, pdf to word, jpg to pdf, edit pdf, sign pdf, protect pdf, watermark pdf, rotate pdf, ocr pdf, organize pdf, search pdf tools, ai support" name="keywords"/>
      <title>All Tool PDF - Searchable Suite of Free Online PDF Tools</title>
      <style>
         :root{--primary-red:#e5322d;--primary-red-dark:#c21a15;--action-green:#28a745;--action-green-dark:#218838;--background-light:#f8f8fa;--background-white:#fff;--text-dark:#333;--text-light:#666;--text-article:#444;--border-color:#e0e0e0;--shadow-light:0 4px 12px rgba(0,0,0,.08);--shadow-strong:0 8px 24px rgba(0,0,0,.15)}*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;background-color:var(--background-light);color:var(--text-dark);line-height:1.6}body.modal-open{overflow:hidden}.container{max-width:1200px;margin:0 auto;padding:0 20px}button{cursor:pointer;font-family:inherit}.header{position:sticky;top:0;width:100%;background-color:var(--background-white);z-index:1000;transition:box-shadow .3s ease;border-bottom:1px solid var(--border-color)}.header.scrolled{box-shadow:var(--shadow-light)}.navbar{display:flex;justify-content:space-between;align-items:center;height:70px}.logo{display:flex;align-items:center;text-decoration:none;cursor:pointer}.nav-menu{display:flex;list-style:none;gap:30px}.nav-menu a{color:var(--text-dark);text-decoration:none;font-weight:500;transition:color .3s ease;cursor:pointer}.nav-menu a:hover{color:var(--primary-red)}.hamburger{display:none;cursor:pointer;z-index:1001}.bar{display:block;width:25px;height:3px;margin:5px auto;background-color:var(--text-dark);transition:all .3s ease-in-out}.hamburger.active .bar:nth-child(2){opacity:0}.hamburger.active .bar:nth-child(1){transform:translateY(8px) rotate(45deg)}.hamburger.active .bar:nth-child(3){transform:translateY(-8px) rotate(-45deg)}.mobile-nav{position:fixed;top:70px;left:-100%;width:100%;height:calc(100vh - 70px);background-color:var(--background-white);display:flex;flex-direction:column;justify-content:center;align-items:center;transition:left .4s ease-in-out;z-index:999}.mobile-nav.active{left:0}.mobile-nav .nav-menu{flex-direction:column;gap:40px;font-size:1.8rem;text-align:center}.hero{text-align:center;padding:70px 20px;background:linear-gradient(180deg,var(--background-white) 0%,var(--background-light) 100%)}.hero h1{font-size:3rem;margin-bottom:15px;color:var(--text-dark)}.hero p{font-size:1.2rem;color:var(--text-light);max-width:600px;margin:0 auto}#tools{padding:60px 0}.search-bar-container{max-width:700px;margin:0 auto 30px auto}#search-bar{width:100%;padding:15px 25px;font-size:1.1rem;border-radius:50px;border:1px solid var(--border-color);outline:none;transition:border-color .3s ease,box-shadow .3s ease;-webkit-appearance:none;background-color:var(--background-white);color:var(--text-dark)}#search-bar:focus{border-color:var(--primary-red);box-shadow:0 0 0 4px rgba(229,50,45,.1)}#search-bar::placeholder{color:#aaa}#tools h2{text-align:center;font-size:2.5rem;margin-bottom:20px;color:var(--text-dark)}.tools-subtitle{text-align:center;max-width:600px;margin:0 auto 40px auto;font-size:1.1rem;color:var(--text-light)}#no-results-message{display:none;text-align:center;margin-top:30px;font-size:1.2rem;color:var(--text-light)}.tools-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:30px}.tool-card{background-color:var(--background-white);border-radius:8px;padding:30px;text-align:center;border:1px solid var(--border-color);cursor:pointer;transition:transform .3s ease,box-shadow .3s ease,border-color .3s ease,background-color .3s ease;display:flex;flex-direction:column;justify-content:center;align-items:center}.tool-card:hover{transform:translateY(-5px);box-shadow:var(--shadow-strong);border-color:var(--primary-red)}.tool-card .icon{margin-bottom:20px; width: 64px; height: 64px; object-fit: contain;}.tool-card h3{font-size:1.2rem;margin-bottom:10px;color:var(--text-dark)}.tool-card p{font-size:.9rem;color:var(--text-light)}.modal{position:fixed;top:0;left:0;width:100%;height:100%;background-color:var(--background-light);z-index:2000;display:none;overflow-y:auto;animation:fadeIn .3s ease}.modal-header-nav{position:sticky;top:0;background-color:var(--background-white);box-shadow:var(--shadow-light);z-index:2001}.modal-navbar{display:flex;justify-content:space-between;align-items:center;height:70px;max-width:1200px;margin:auto;padding:0 20px}.modal-navbar .hamburger{display:none}.modal-navbar .nav-menu{display:flex}.modal-close-btn{font-size:2.5rem;color:var(--text-light);cursor:pointer;border:none;background:none;margin-left:20px}.modal-content-area{max-width:1200px;margin:40px auto;padding:0 20px}.modal-tool-title{text-align:center;font-size:2.5rem;margin-bottom:30px;color:var(--text-dark)}.drop-area{border:3px dashed var(--border-color);border-radius:8px;padding:50px;text-align:center;cursor:pointer;transition:border-color .3s,background-color .3s}.drop-area.dragover{border-color:var(--primary-red);background-color:#fff8f7}.drop-area-text{font-size:1.1rem;color:var(--text-light)}.drop-area-text span{background-color:var(--action-green);color:white;padding:16px 80px;border-radius:8px;font-weight:600;display:inline-block;margin-top:15px;transition:background-color .2s ease;font-size:1.1rem}#file-input{display:none}.file-list{margin-top:20px}.file-item{display:flex;justify-content:space-between;align-items:center;background-color:var(--background-white);border:1px solid var(--border-color);padding:10px 15px;border-radius:4px;margin-bottom:10px;font-size:.9rem}.remove-file{cursor:pointer;color:var(--primary-red);font-weight:700;border:none;background:none;font-size:1.2rem}.tool-options{margin-top:30px}.tool-options:not(:empty){padding-top:20px;border-top:1px solid var(--border-color)}.tool-options label{display:block;margin-bottom:10px;font-weight:600}.tool-options input,.tool-options select{width:100%;padding:10px;border-radius:4px;border:1px solid var(--border-color);margin-bottom:15px;background-color:var(--background-white);color:var(--text-dark)}.article-content{margin-top:50px;padding-top:30px;border-top:2px solid var(--border-color);color:var(--text-article)}.article-content h3{font-size:1.8rem;margin-bottom:15px;color:var(--primary-red)}.article-content h4{font-size:1.4rem;margin-top:25px;margin-bottom:15px}.article-content p,.article-content li{margin-bottom:15px;font-size:1.05rem;line-height:1.7}.article-content ul,.article-content ol{padding-left:25px}.static-modal-content{background-color:var(--background-white);padding:2rem;border-radius:8px}.static-modal-content h2{font-size:2.2rem;margin-bottom:20px;color:var(--primary-red)}.static-modal-content a{color:var(--primary-red)}.process-btn{display:block;width:100%;padding:15px;background-color:var(--primary-red);color:white;border:none;border-radius:8px;font-size:1.2rem;font-weight:700;cursor:pointer;transition:background-color .3s,display .3s;margin-top:30px}.process-btn:hover:not(:disabled){background-color:var(--primary-red-dark)}.process-btn:disabled{background-color:#ccc;cursor:not-allowed}#output-area{margin-top:40px;display:flex;flex-direction:column;align-items:center;gap:20px;width:100%}.download-container{text-align:center;background-color:var(--background-white);padding:20px;border-radius:8px;border:1px solid var(--border-color);width:100%;max-width:500px}.download-container p{margin-bottom:15px;font-weight:500;word-break:break-all}.download-link{display:inline-block;padding:16px 80px;font-size:1.1rem;background-color:var(--action-green);color:white;text-decoration:none;border-radius:8px;font-weight:600;transition:background-color .2s ease;border:none}.download-link:hover{background-color:var(--action-green-dark)}.loader-container{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(255,255,255,.9);z-index:3000;display:none;flex-direction:column;justify-content:center;align-items:center}.loader{border:8px solid #f3f3f3;border-top:8px solid var(--primary-red);border-radius:50%;width:60px;height:60px;animation:spin 1s linear infinite}#loader-text{margin-top:20px;font-size:1rem;font-weight:500;color:var(--text-dark)}#support-fab{position:fixed;bottom:30px;right:30px;background-color:var(--primary-red);color:white;width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;cursor:pointer;box-shadow:var(--shadow-strong);z-index:1010;transition:transform .3s ease}#support-fab:hover{transform:scale(1.1)}#ai-chat-modal{position:fixed;bottom:100px;right:30px;width:370px;max-width:90vw;height:500px;max-height:70vh;background-color:var(--background-white);border-radius:12px;box-shadow:var(--shadow-strong);z-index:1009;display:flex;flex-direction:column;overflow:hidden;animation:fadeIn .3s ease}.chat-header{background-color:var(--primary-red);color:white;padding:15px;display:flex;justify-content:space-between;align-items:center}.chat-header h4{margin:0;font-size:1.1rem}#close-chat-btn{font-size:1.5rem;background:none;border:none;color:white;cursor:pointer}.chat-messages{flex-grow:1;padding:15px;overflow-y:auto;display:flex;flex-direction:column;gap:12px;background-color:var(--background-light)}.chat-message{padding:10px 15px;border-radius:18px;max-width:80%;line-height:1.4}.user-message{background-color:#e0e0e0;color:var(--text-dark);align-self:flex-end;border-bottom-right-radius:4px}.ai-message{background-color:var(--primary-red);color:white;align-self:flex-start;border-bottom-left-radius:4px}.chat-form{display:flex;padding:15px;border-top:1px solid var(--border-color)}#chat-input{flex-grow:1;padding:10px;border:1px solid var(--border-color);border-radius:20px;outline:none}#chat-submit{background:none;border:none;font-size:1.5rem;color:var(--primary-red);margin-left:10px;cursor:pointer}.hidden{display:none!important}.footer{background-color:#2c3e50;background-image:linear-gradient(135deg,#34495e 0%,#2c3e50 100%);color:#ecf0f1;padding:60px 0 40px 0;font-size:.95rem}.footer-grid{display:grid;grid-template-columns:2fr repeat(4,1fr);gap:40px;max-width:1200px;margin:0 auto;padding:0 20px}.footer-col h4{margin-bottom:20px;color:#fff;font-weight:600;text-transform:uppercase;font-size:1rem}.footer-col p{line-height:1.7;color:#bdc3c7}.footer-col ul{list-style:none}.footer-col ul li{margin-bottom:12px}.footer-col ul li a{color:#bdc3c7;text-decoration:none;transition:color .3s;cursor:pointer}.footer-col ul li a:hover{color:var(--primary-red)}.footer-contact{margin-top:20px}.whatsapp-link{display:inline-flex;align-items:center;gap:10px;color:#bdc3c7;text-decoration:none;transition:color .3s}.whatsapp-link:hover{opacity:0.8}.footer-bottom{text-align:center;margin-top:40px;padding-top:20px;border-top:1px solid #46627f;color:#95a5a6;font-size:.9rem}
         #pdf-editor-container{display:none;flex-direction:column;align-items:center;gap:15px;position:relative}
         #editor-toolbar{position:sticky;top:70px;z-index:10;display:flex;flex-direction:column;gap:8px;padding:10px;background-color:var(--background-white);border-radius:8px;border:1px solid var(--border-color);margin-bottom:15px;max-width:fit-content;margin-left:auto;margin-right:auto}
         #toolbar-top-row,#toolbar-bottom-row{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:8px;width:100%}
         .tool-group{display:flex;align-items:center;gap:8px;padding:0 10px}
         .tool-group:not(:last-child){border-right:1px solid var(--border-color)}
         #editor-toolbar label{font-weight:500;margin:0 5px 0 0;user-select:none}
         #editor-toolbar select,#editor-toolbar input[type=number]{padding:4px 8px;border-radius:4px;border:1px solid var(--border-color);height:34px}
         #universal-size{width:70px}
         #editor-toolbar button{padding:6px;border-radius:4px;border:1px solid var(--border-color);background-color:#fff;font-weight:500;font-size:16px;line-height:1;min-width:38px;height:38px;display:flex;justify-content:center;align-items:center}
         #editor-toolbar button svg{width:20px;height:20px;fill:var(--text-dark)}
         #editor-toolbar button.active{background-color:var(--primary-red);border-color:var(--primary-red)}
         #editor-toolbar button.active svg,#editor-toolbar button.active{color:white}
         #editor-toolbar button.active svg{fill:white}
         .font-style-buttons{display:flex;border:1px solid var(--border-color);border-radius:4px;overflow:hidden}
         .font-style-buttons button{font-family:'Times New Roman',Times,serif;min-width:30px;padding:4px 8px;border:none;border-radius:0;border-right:1px solid var(--border-color);height:32px}
         .font-style-buttons button:last-child{border-right:none}
         .font-style-buttons button.active{background-color:#ffc107;border-color:#ffc107;color:#000}
         .bold{font-weight:bold}
         .italic{font-style:italic}
         .underline{text-decoration:underline}
         .color-palette-container{display:flex;align-items:center;gap:8px}
         #selected-color-view{width:28px;height:28px;border:1px solid #ccc;background-color:#000;cursor:pointer}
         .color-grid{display:grid;grid-template-columns:repeat(10,1fr);gap:2px}
         .color-box{width:20px;height:20px;border:1px solid #ccc;cursor:pointer}
         #text-editor-input{position:absolute;display:none;z-index:20;padding:2px;border:1px dashed var(--primary-red);background:rgba(255,255,255,.9);line-height:1;white-space:nowrap;cursor:move}
         #pdf-canvas{border:1px solid var(--border-color);border-radius:4px;max-width:100%;height:auto;cursor:default}
         #editor-pagination{display:none;align-items:center;gap:15px;margin-top:10px}
         #editor-pagination button{padding:8px 16px;background-color:var(--primary-red);color:white;border:none;border-radius:4px;font-weight:600}
         #editor-pagination button:disabled{background-color:#ccc;cursor:not-allowed}
         #page-indicator{font-weight:600}
         fieldset{border:none;padding:0;margin:0;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:8px}
         fieldset:disabled{opacity:.5;pointer-events:none}
         
         #delete-pages-viewer { display: none; flex-direction: column; background-color: white; padding: 15px; border-radius: 8px; border: 1px solid var(--border-color); }
         #delete-pages-toolbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid var(--border-color); flex-wrap: wrap; gap: 10px; }
         #pdf-file-name { font-weight: bold; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 250px; }
         .zoom-controls { display: flex; align-items: center; gap: 10px; }
         .zoom-controls button { font-size: 1.5rem; width: 36px; height: 36px; border-radius: 50%; border: 1px solid var(--border-color); background-color: #f0f0f0; display: flex; align-items: center; justify-content: center; }
         .zoom-controls span { font-weight: 600; }
         .actions { display: flex; align-items: center; gap: 15px; }
         #download-deleted-btn { background-color: var(--primary-red); color: white; padding: 16px 80px; border-radius: 8px; font-weight: 600; border: none; font-size: 1.1rem; }
         .action-dropdown { position: relative; display: flex; }
         #process-selection-btn { padding: 8px; border-radius: 5px 0 0 5px; border: none; color: white; line-height: 1; transition: background-color 0.2s; }
         #action-toggle-btn { padding: 8px 10px; border-radius: 0 5px 5px 0; border: none; color: white; transition: background-color 0.2s; }
         .action-dropdown .delete-mode, .action-dropdown .delete-mode:hover { background-color: var(--primary-red); border-right: 1px solid var(--primary-red-dark); }
         .action-dropdown .save-mode, .action-dropdown .save-mode:hover { background-color: var(--action-green); border-right: 1px solid var(--action-green-dark); }
         #action-menu { position: absolute; top: 105%; right: 0; background-color: white; border: 1px solid var(--border-color); border-radius: 5px; box-shadow: var(--shadow-light); list-style: none; padding: 5px 0; z-index: 10; min-width: 150px; }
         #action-menu.hidden { display: none; }
         #action-menu li { padding: 10px 15px; cursor: pointer; display: flex; align-items: center; gap: 8px; }
         #action-menu li:hover { background-color: #f0f0f0; }
         #action-menu li svg { width: 18px; height: 18px; }

         #delete-layout-container { display: flex; gap: 15px; height: 70vh; }
         #page-thumbnails-sidebar { width: 200px; overflow-y: auto; background-color: #f8f8fa; border: 1px solid var(--border-color); border-radius: 5px; padding: 10px; display: flex; flex-direction: column; gap: 10px; }
         #main-page-viewer { flex: 1; background-color: #e9e9e9; border-radius: 5px; overflow: auto; padding: 10px; display: flex; justify-content: flex-start; align-items: flex-start; }
         #main-viewer-canvas { box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
         .thumbnail-item { position: relative; border: 2px solid transparent; border-radius: 4px; padding: 5px; text-align: center; background: white; cursor: pointer; transition: border-color 0.2s; }
         .thumbnail-item:hover { border-color: #aaa; }
         .thumbnail-item.active { border-color: var(--primary-red); box-shadow: 0 0 8px rgba(229, 50, 45, 0.5); }
         .thumbnail-item canvas { width: 100%; height: auto; border: 1px solid #ccc; }
         .thumbnail-item .page-number { font-size: 0.9rem; margin-top: 5px; font-weight: 500; }
         .thumbnail-item input[type="checkbox"] { position: absolute; top: 10px; left: 10px; width: 25px; height: 25px; accent-color: black; cursor: pointer; }


         @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.reveal{opacity:0;transform:translateY(30px);transition:opacity .6s ease,transform .6s ease}.reveal.active{opacity:1;transform:translateY(0)}@media (max-width:992px){.footer-grid{grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}}@media (max-width:768px){.nav-menu{display:none}.hamburger{display:block}.footer-grid{grid-template-columns:1fr;text-align:center}.footer-grid .footer-col:first-child{align-items:center;display:flex;flex-direction:column}}@media (max-width:576px){.hero h1{font-size:2.2rem}.modal-tool-title{font-size:1.8rem}#ai-chat-modal{bottom:80px;right:15px}#support-fab{bottom:20px;right:20px}}
      </style>
   </head>
   <body>
      <div id="main-page">
         <header class="header">
            <div class="container">
               <nav class="navbar">
                  <a href="#tools" class="logo" style="gap: 10px; text-decoration: none;">
                     <img src="logo.png" alt="PDF Logo" style="width: 60px; height: 65px;">
                     <div style="line-height: 1;">
                        <span style="font-weight: bold; font-size: 25px; color: black;">All <br>
                        Tool <span style="color: #e5322d;">PDF</span></span>
                     </div>
                  </a>
                  <ul class="nav-menu">
                     <li><a class="nav-link-home" href="#main-page">Home</a></li>
                     <li><a class="nav-link-tools" href="#tools">All Tools</a></li>
                     <li><a class="nav-link-about">About</a></li>
                     <li><a class="nav-link-contact">Contact</a></li>
                  </ul>
                  <div class="hamburger">
                     <span class="bar"></span><span class="bar"></span><span class="bar"></span>
                  </div>
               </nav>
            </div>
         </header>
         <nav class="mobile-nav">
            <ul class="nav-menu">
               <li><a class="nav-link-home" href="#main-page">Home</a></li>
               <li><a class="nav-link-tools" href="#tools">All Tools</a></li>
               <li><a class="nav-link-about">About</a></li>
               <li><a class="nav-link-contact">Contact</a></li>
            </ul>
         </nav>
         <main>
            <section class="hero">
               <div class="container">
                  <h1 class="reveal">The Complete Suite of Free Online PDF Tools</h1>
                  <p class="reveal">Every tool you need to work with PDFs, right in your browser. Fast, free, and secure.</p>
               </div>
            </section>
            <section id="tools">
               <div class="container">
                  <div class="search-bar-container reveal">
                     <input id="search-bar" placeholder="?? Search for a tool (e.g., 'merge', 'word', 'sign')..." type="text"/>
                  </div>
                  <h2 class="reveal">All PDF Tools</h2>
                  <p class="tools-subtitle reveal">Securely manage your documents with our 27 powerful, browser-based PDF tools. No uploads, no installations, just results.</p>
                  <div class="tools-grid" id="tools-grid"></div>
                  <p id="no-results-message">No tools found matching your search.</p>
               </div>
            </section>
         </main>
         <footer class="footer">
            <div class="footer-grid">
               <div class="footer-col">
                  <a href="#tools" class="logo" style="gap: 12px; text-decoration: none;">
                     <img src="footer.png" alt="Logo" style="width: 100px; height: 110px;">
                     <div style="line-height: 1;">
                        <span style="font-weight: bold; font-size: 40px; color: black;">All <br>
                        Tool <span style="color: #e5322d;">PDF</span></span>
                     </div>
                  </a>
                  <p>Your all-in-one solution for PDF management. Free, secure, and entirely client-side.</p>
                  <div class="footer-contact">
                     <a href="https://wa.me/923356231029" target="_blank" class="whatsapp-link">
                         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="width: 48px; height: 48px;">
                            <path fill="#25D366" d="M380.9 97.1C346.6 62.8 297.6 42.7 242.3 42.7c-52.9 0-101 20.3-138.6 57.8C66 138.2 46.5 186.2 46.5 238.9c0 23.3 4.2 45.7 12.3 66.8L28.3 440.3l108.9-28.5c20.8 7.5 43.1 11.4 65.1 11.4h.1c55.3 0 106.8-21.4 144.5-59.2C394.3 325 414 274.6 414 221.7c0-54.3-20.7-104.9-53.1-124.6zM242.3 400.3c-20.3 0-40.2-5.5-57.8-15.9l-4.1-2.4-42.9 11.3 11.5-42-2.6-4.3c-11.1-18.4-16.9-39.2-16.9-60.8 0-45 17.5-87.3 49.6-119.3 32.1-32.1 74.4-49.6 119.3-49.6 44.1 0 86.4 17.2 118.5 49.3s49.3 74.4 49.3 118.5c0 47.9-18.8 92.8-52.1 126.1-33.1 33.3-77.9 51.1-125.1 51.1zM196.5 155c-2.3-5.2-4.7-5.3-6.9-5.4-2.2-.1-4.7-.1-7.1-.1-2.4 0-6.3 1.1-9.6 5.4-3.3 4.3-12.7 12.5-12.7 30.5 0 18.1 13 35.3 14.8 37.6 1.8 2.4 25.4 39.9 62.5 55.4 37.1 15.5 37.1 10.3 43.8 9.6 6.7-0.7 20.9-8.5 23.8-16.8 3-8.3 3-15.4 2.1-16.8-1-1.4-3.8-2.3-8-4.3-4.2-2-20.9-10.3-24.1-11.5s-5.6-1.8-8 1.8c-2.4 3.7-9.1 11.5-11.1 13.9-2.1 2.4-4.2 2.6-7.8 1.1-3.6-1.5-15.1-5.5-28.7-17.7-10.7-9.8-17.9-21.9-20-25.6-2.1-3.7-.4-5.6 1.3-7.4 1.7-1.7 3.7-4.3 5.4-6.3 1.7-2 2.3-3.7 3.3-6.1.9-2.5.4-4.7-.2-6.2z"/>
                         </svg>
                     </a>
                  </div>
               </div>
               <div class="footer-col"><h4>Convert from PDF</h4><ul><li><a class="footer-tool-link" data-tool="pdf-to-word">PDF to Word</a></li><li><a class="footer-tool-link" data-tool="pdf-to-jpg">PDF to Image (PNG)</a></li><li><a class="footer-tool-link" data-tool="pdf-to-powerpoint">PDF to PowerPoint</a></li><li><a class="footer-tool-link" data-tool="pdf-to-excel">PDF to Excel</a></li></ul></div>
               <div class="footer-col"><h4>Convert to PDF</h4><ul><li><a class="footer-tool-link" data-tool="word-to-pdf">Word to PDF</a></li><li><a class="footer-tool-link" data-tool="jpg-to-pdf">Image to PDF</a></li><li><a class="footer-tool-link" data-tool="powerpoint-to-pdf">PowerPoint to PDF</a></li><li><a class="footer-tool-link" data-tool="html-to-pdf">HTML to PDF</a></li></ul></div>
               <div class="footer-col"><h4>Organize</h4><ul><li><a class="footer-tool-link" data-tool="merge-pdf">Merge PDF</a></li><li><a class="footer-tool-link" data-tool="split-pdf">Split PDF</a></li><li><a class="footer-tool-link" data-tool="rearrange-pages">Rearrange Pages</a></li><li><a class="footer-tool-link" data-tool="delete-pdf-pages">Delete Pages</a></li></ul></div>
               <div class="footer-col"><h4>Secure &amp; Edit</h4><ul><li><a class="footer-tool-link" data-tool="protect-pdf">Protect PDF</a></li><li><a class="footer-tool-link" data-tool="unlock-pdf">Unlock PDF</a></li><li><a class="footer-tool-link" data-tool="esign-pdf">eSign PDF</a></li><li><a class="footer-tool-link" data-tool="watermark-pdf">Watermark PDF</a></li></ul></div>
            </div>
            <div class="footer-bottom"><p>© 2024 All Tool PDF. All Rights Reserved. | <a class="nav-link-privacy">Privacy Policy</a> | <a class="nav-link-terms">Terms & Conditions</a></p></div>
         </footer>
      </div>
      <!-- Modals Container -->
      <div id="modal-container">
         <div class="modal" id="tool-modal">
             <header class="modal-header-nav">
                <div class="modal-navbar">
                    <div style="display: flex; align-items: center; gap: 15px; flex-shrink: 0; min-width: 0;">
                        <button class="modal-close-btn" title="Back to Tools" style="background:none; border:none; cursor:pointer; padding:0; line-height: 1;">
                            <svg xmlns="http://www.w3.org/2000/svg" height="28" viewBox="0 96 960 960" width="28" fill="#555"><path d="M382.5 816 120 553.5 382.5 291l43 43-220 220 219.5 219.5-42.5 42.5Z"/></svg>
                        </button>
                        <a href="#" class="logo close-modal-link" style="flex-shrink: 1; min-width: 0;"></a>
                    </div>
                    <div style="display:flex;align-items:center">
                       <ul class="nav-menu">
                          <li><a class="nav-link-home">Home</a></li>
                          <li><a class="nav-link-tools">All Tools</a></li>
                          <li><a class="nav-link-about">About</a></li>
                          <li><a class="nav-link-contact">Contact</a></li>
                       </ul>
                       <button class="modal-close-btn" style="margin-left:20px; font-size: 2.5rem; color: var(--text-light);">&times;</button>
                    </div>
                </div>
             </header>
            <div class="modal-content-area">
               <h2 class="modal-tool-title">Tool Title</h2>
               <div class="drop-area" id="drop-area"><input id="file-input" multiple type="file"/><p class="drop-area-text">Drag &amp; drop files here or <br/><span>Click to Select</span></p></div>
               
               <div id="delete-pages-viewer">
                  <div id="delete-pages-toolbar">
                      <span id="pdf-file-name"></span>
                      <div class="zoom-controls">
                          <button id="zoom-out-btn">-</button>
                          <span id="zoom-level">100%</span>
                          <button id="zoom-in-btn">+</button>
                      </div>
                      <div class="actions">
                          <div class="action-dropdown">
                               <button id="process-selection-btn"></button>
                               <button id="action-toggle-btn"><svg fill="white" xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg></button>
                               <ul id="action-menu" class="hidden">
                                   <li data-action="delete"><svg fill="#333" xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"/></svg> Delete Selected</li>
                                   <li data-action="save"><svg fill="#333" xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><path d="M48 96V416c0 8.8 7.2 16 16 16H384c8.8 0 16-7.2 16-16V170.5c0-4.2-1.7-8.3-4.7-11.3l-33.9-33.9c-3-3-7.1-4.7-11.3-4.7H64c-8.8 0-16 7.2-16 16zM160 352c-17.7 0-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32s-14.3 32-32 32zM320 128H64V96h256v32z"/></svg> Save Selected</li>
                               </ul>
                           </div>
                          <button id="download-deleted-btn">Download</button>
                      </div>
                  </div>
                  <div id="delete-layout-container">
                      <div id="page-thumbnails-sidebar"></div>
                      <div id="main-page-viewer">
                          <canvas id="main-viewer-canvas"></canvas>
                      </div>
                  </div>
               </div>

               <div id="pdf-editor-container">
                  <div id="editor-toolbar">
                     <div id="toolbar-top-row">
                        <div class="tool-group">
                           <button id="select-tool-btn" title="Select"><svg viewBox="0 0 24 24"><path d="M13.62,15.38L12.5,12.5L9.62,13.62L5.5,2.5L18.5,6.5L13.62,15.38M11.1,10.1L12.5,6.5L14.9,7.9L13.5,11.5L11.1,10.1Z"></path></svg></button>
                           <button id="draw-tool-btn" title="Draw"><svg viewBox="0 0 24 24"><path d="M16.29,3.29L14,5.59L18.41,10L20.71,7.71C21.1,7.32 21.1,6.69 20.71,6.3L17.7,3.29C17.31,2.9 16.68,2.9 16.29,3.29M13,6.59L3,16.59V20H6.41L16.41,10L13,6.59Z"></path></svg></button>
                           <button id="text-tool-btn" class="active" title="Text"><svg viewBox="0 0 24 24"><path d="M18.5,4L19.66,8.35L18.7,8.61C18.25,7.74 17.79,6.87 17.26,6.43C16.73,6 16.11,6 15.5,6H13V16.5C13,17 13,17.5 13.33,17.75C13.67,18 14.17,18 15,18V19H9V18C9.83,18 10.33,18 10.67,17.75C11,17.5 11,17 11,16.5V6H8.5C7.89,6 7.27,6 6.74,6.43C6.21,6.87 5.75,7.74 5.3,8.61L4.34,8.35L5.5,4H18.5Z"></path></svg></button>
                           <button id="erase-tool-btn" title="Erase"><svg viewBox="0 0 24 24"><path d="M16.24,3.56L21.19,8.5C21.58,8.89 21.58,9.5 21.19,9.9L11.9,19.2C11.5,19.6 10.89,19.6 10.5,19.2L5.55,14.26C5.16,13.87 5.16,13.24 5.55,12.85L14.85,3.56C15.24,3.17 15.85,3.17 16.24,3.56M17.31,2.5L14.13,5.68L18.32,9.87L21.5,6.69C22.67,5.52 22.28,3.55 20.93,2.2L17.31,2.5M4.14,13.26L9.09,18.2L2.8,21.95L4.14,13.26Z"></path></svg></button>
                        </div>
                        <div class="tool-group">
                           <button id="line-tool-btn" title="Line"><svg viewBox="0 0 24 24"><path d="M22,2L2,22H2V21.59L21.59,2H22M2,3.41L20.59,22H22V20.59L3.41,2H2V3.41Z"></path></svg></button>
                           <button id="rectangle-tool-btn" title="Rectangle"><svg viewBox="0 0 24 24"><path d="M4,6V18H20V6H4M18,16H6V8H18V16Z"></path></svg></button>
                           <button id="circle-tool-btn" title="Circle"><svg viewBox="0 0 24 24"><path d="M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8M12,14C10.9,14 10,13.1 10,12C10,10.9 10.9,10 12,10C13.1,10 14,10.9 14,12C14,13.1 13.1,14 12,14M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"></path></svg></button>
                        </div>
                     </div>
                     <div id="toolbar-bottom-row">
                        <div class="tool-group">
                           <label for="font-family">Font:</label>
                           <select id="font-family">
                              <option>Arial</option><option>Verdana</option><option>Times New Roman</option><option>Courier New</option><option>sans-serif</option>
                           </select>
                        </div>
                        <div class="tool-group">
                           <label for="universal-size">Size:</label>
                           <input type="number" id="universal-size" value="48" min="1">
                           <div class="font-style-buttons" id="font-style-buttons">
                              <button id="bold-btn" class="bold" title="Bold">B</button>
                              <button id="italic-btn" class="italic" title="Italic">I</button>
                              <button id="underline-btn" class="underline" title="Underline">U</button>
                           </div>
                        </div>
                        <div class="tool-group">
                           <label for="fill-shape-check">Fill:</label>
                           <input type="checkbox" id="fill-shape-check" title="Fill Shape">
                        </div>
                        <div class="tool-group color-palette-container">
                           <label>Color:</label>
                           <div id="selected-color-view" class="selected-color-view"></div>
                           <div id="color-grid" class="color-grid"></div>
                           <input type="color" id="color-picker" value="#000000" title="Select Color" style="width:0; height:0; padding:0; border:none; opacity:0; position:absolute;">
                        </div>
                     </div>
                  </div>
                  <canvas id="pdf-canvas"></canvas>
                  <input type="text" id="text-editor-input"/>
                  <div id="editor-pagination">
                     <button id="prev-page-btn">Previous Page</button>
                     <span id="page-indicator">Page 1 / 1</span>
                     <button id="next-page-btn">Next Page</button>
                  </div>
               </div>
               <div class="file-list" id="file-list"></div>
               <div class="tool-options" id="tool-options"></div>
               <button class="process-btn" disabled id="process-btn">Convert</button>
               <div id="output-area"></div>
               <div class="article-content" id="tool-article-container"></div>
            </div>
         </div>
         <div class="modal" id="static-modal-template" style="display:none">
             <header class="modal-header-nav">
                <div class="modal-navbar">
                    <div style="display: flex; align-items: center; gap: 15px; flex-shrink: 0; min-width: 0;">
                        <button class="modal-close-btn" title="Back to Tools" style="background:none; border:none; cursor:pointer; padding:0; line-height: 1;">
                            <svg xmlns="http://www.w3.org/2000/svg" height="28" viewBox="0 96 960 960" width="28" fill="#555"><path d="M382.5 816 120 553.5 382.5 291l43 43-220 220 219.5 219.5-42.5 42.5Z"/></svg>
                        </button>
                        <a href="#" class="logo close-modal-link" style="flex-shrink: 1; min-width: 0;"></a>
                    </div>
                    <div style="display:flex;align-items:center">
                       <ul class="nav-menu">
                          <li><a class="nav-link-home">Home</a></li>
                          <li><a class="nav-link-tools">All Tools</a></li>
                          <li><a class="nav-link-about">About</a></li>
                          <li><a class="nav-link-contact">Contact</a></li>
                       </ul>
                       <button class="modal-close-btn" style="margin-left:20px; font-size: 2.5rem; color: var(--text-light);">&times;</button>
                    </div>
                </div>
             </header>
            <div class="modal-content-area"><div class="static-modal-content"><h2 id="static-modal-title"></h2><div class="article-content" id="static-modal-body" style="border-top:none;margin-top:0;padding-top:0"></div></div></div>
         </div>
      </div>
      <!-- Floating Action Button & AI Chat -->
      <div id="support-fab" title="Contact Support Team">??</div>
      <div id="ai-chat-modal" class="hidden"><div class="chat-header"><h4>Support Team</h4><button id="close-chat-btn">&times;</button></div><div class="chat-messages" id="chat-messages-container"><div class="chat-message ai-message">Welcome! How can I help you with your PDFs today?</div></div><form class="chat-form" id="chat-form"><input type="text" id="chat-input" placeholder="Type your message..." autocomplete="off"><button type="submit" id="chat-submit" title="Send">?</button></form></div>
      <div class="loader-container" id="loader-container"><div class="loader"></div><p id="loader-text">Processing...</p></div>
      <!-- SEO Blog Content -->
      <div id="all-tool-articles" style="display:none">
         <div id="article-pdf-to-word"><h3>Free Online PDF to Word Converter</h3><p>Unlock the content within your PDFs by converting them into fully editable Microsoft Word documents (DOCX). Our free <strong>PDF to Word converter</strong> is an essential online PDF tool for students, professionals, and anyone who needs to modify or reuse text from a PDF file. The conversion maintains your original formatting, so you can start editing right away.</p><h4>Key Benefits of Converting PDF to Word</h4><ul><li><strong>Edit with Ease:</strong> Directly edit text, tables, and images from your PDF in a familiar Word interface. Correct typos, update information, or repurpose content without starting from scratch.</li><li><strong>Secure and Private:</strong> Your files are processed in the browser. They are never uploaded to our servers, guaranteeing the privacy of your sensitive documents.</li></ul><h4>How to Convert PDF to Word Online</h4><ol><li><strong>Step 1: Upload Your PDF:</strong> Drag and drop your PDF file into the drop area above, or click the button to select a file from your computer.</li><li><strong>Step 2: Start the Conversion:</strong> The tool will automatically begin the process of converting your file from PDF to DOCX format.</li><li><strong>Step 3: Process and Download:</strong> Within seconds, your new, editable Word document will be ready. Click the 'Download' button to save the file to your device.</li></ol></div>
         <div id="article-pdf-to-jpg"><h3>High-Quality PDF to Image Converter</h3><p>Transform each page of your PDF document into a high-quality PNG image with our <strong>free PDF to Image converter</strong>. This online PDF tool is perfect for when you need to share a document page on social media, embed it in a presentation, or use it in a design project, especially when clarity of text and lines is important. The process is fast, secure, and preserves the visual fidelity of your original file.</p><h4>Why Convert PDF to PNG?</h4><ul><li><strong>Maximum Quality:</strong> PNG is a lossless format, which means it perfectly preserves text, barcodes, and sharp lines without blurriness.</li><li><strong>Easy Sharing:</strong> Images are easier to share on websites, in emails, and on social media platforms.</li><li><strong>Browser-Based Security:</strong> Your PDF is converted directly in your browser. No file uploads mean your data remains completely private.</li></ul><h4>How to Convert PDF to PNG for Free</h4><ol><li><strong>Step 1: Select Your PDF:</strong> Click the upload area to choose the PDF file you wish to convert, or simply drag and drop it.</li><li><strong>Step 2: Let the Tool Work:</strong> Our system will instantly begin converting each page into a separate, high-quality PNG image file.</li><li><strong>Step 3: Download Your Images:</strong> Once complete, download links for each PNG will appear.</li></ol></div>
         <div id="article-merge-pdf"><h3>Seamlessly Merge PDF Files Online</h3><p>Combine multiple PDF documents into a single, organized file with our powerful and <strong>free Merge PDF tool</strong>. This online utility is perfect for consolidating reports, combining invoices, or creating a single document from various sources. The process is incredibly fast, and because it happens in your browser, your files remain completely secure.</p><h4>Benefits of Using Our Online PDF Merger</h4><ul><li><strong>Improved Organization:</strong> Keep your projects tidy by merging related documents into one file. It's much easier to manage, share, and archive a single PDF.</li><li><strong>Streamlined Workflow:</strong> Save time by combining files with just a few clicks instead of handling multiple attachments.</li><li><strong>Total Security:</strong> Your privacy is our priority. Files are merged directly on your device, not on our servers.</li></ul><h4>How to Merge PDF Files in 3 Simple Steps</h4><ol><li><strong>Step 1: Upload Your PDFs:</strong> Drag and drop all the PDF files you want to combine into the drop zone, or click to select them.</li><li><strong>Step 2: Arrange Your Files:</strong> After uploading, easily reorder the files by dragging them into the correct sequence.</li><li><strong>Step 3: Merge and Download:</strong> Click 'Convert', and a download link for the merged PDF will appear instantly.</li></ol></div>
         <div id="article-split-pdf"><h3>Easily Split PDF Files Online</h3><p>Our <strong>free Split PDF tool</strong> allows you to extract one or more pages from a PDF or divide a large document into several smaller, more manageable files. Whether you need to separate chapters, isolate a specific report, or reduce file size for sharing, this online PDF tool offers the flexibility you need. The entire process is performed securely in your browser, protecting your data.</p><h4>Why You Should Use a PDF Splitter</h4><ul><li><strong>Extract Key Pages:</strong> Easily pull out specific pages from a large PDF document without needing to keep the entire file.</li><li><strong>Organize Large Documents:</strong> Break down a large manual into separate chapters or sections for easier reading.</li><li><strong>Client-Side Security:</strong> This tool processes your files directly on your computer, ensuring they remain private.</li></ul><h4>How to Split a PDF Online for Free</h4><ol><li><strong>Step 1: Upload Your PDF:</strong> Click the upload area or drag and drop the PDF file you want to split.</li><li><strong>Step 2: Define the Page Range:</strong> In the options, specify the exact pages or ranges you want to extract (e.g., '2-5, 8').</li><li><strong>Step 3: Split and Download:</strong> Click 'Convert'. The tool creates a new PDF with only your selected pages, ready for download.</li></ol></div>
         <div id="article-protect-pdf"><h3>Secure Your Documents with a Password</h3><p>Add a strong layer of security to your sensitive documents with our <strong>free Protect PDF tool</strong>. This utility lets you encrypt your PDF with a password, preventing unauthorized users from opening it. It’s an essential step for sharing confidential information like contracts or reports. Best of all, the entire process happens securely in your browser.</p><h4>Advantages of Password Protecting PDFs</h4><ul><li><strong>Confidentiality Assured:</strong> Ensure that only individuals with the correct password can access your document.</li><li><strong>Prevent Unauthorized Access:</strong> Protect files from being opened by unintended recipients when sent via email.</li><li><strong>Completely Secure Processing:</strong> Your PDF is encrypted directly on your device, never uploaded to our servers.</li></ul><h4>How to Add a Password to a PDF</h4><ol><li><strong>Step 1: Select the PDF File:</strong> Drag and drop your PDF into the upload area or click to select it.</li><li><strong>Step 2: Set a Secure Password:</strong> In the options field, type a strong and unique password.</li><li><strong>Step 3: Encrypt and Download:</strong> Click 'Convert'. Our tool will instantly apply password protection and generate your download.</li></ol></div>
         <div id="article-word-to-pdf"><h3>Create Professional PDFs from Word</h3><p>Our <strong>free Word to PDF converter</strong> transforms your Microsoft Word documents (.docx, .doc) into high-quality, universally readable PDF files. This is perfect for sending resumes, reports, or invoices in a format that looks professional and cannot be easily altered. Our tool ensures your document's formatting, fonts, and images are perfectly preserved.</p><h4>Why Convert Word to PDF?</h4><ul><li><strong>Universal Compatibility:</strong> PDFs can be opened on any device or operating system and will always look the same.</li><li><strong>Professional Appearance:</strong> Sending a document as a PDF is the standard for professional communication, preventing accidental edits.</li><li><strong>Secure and Private:</strong> Your document is converted right in your browser. It is never sent to our servers, keeping your data safe.</li></ul><h4>How to Convert Word to PDF Online</h4><ol><li><strong>Step 1: Select Your Word File:</strong> Drag and drop your .docx or .doc file into the upload area.</li><li><strong>Step 2: Begin Conversion:</strong> The conversion to a high-quality PDF will start automatically.</li><li><strong>Step 3: Download Your PDF:</strong> Click the download link to save your newly created PDF file.</li></ol></div>
         <div id="article-excel-to-pdf"><h3>High-Quality Excel to PDF Converter</h3><p>Transform your Excel spreadsheets (.xlsx, .xls) into professional, easy-to-share PDF documents with our <strong>free Excel to PDF converter</strong>. This tool is perfect for creating reports, invoices, or financial summaries that need to be presented in a clean, fixed-layout format. It preserves your tables, charts, and formatting, creating a crisp and clear PDF.</p><h4>Benefits of Converting Excel to PDF</h4><ul><li><strong>Clean Presentation:</strong> Share your data in a clean, non-editable format that is perfect for printing or professional review.</li><li><strong>Data Integrity:</strong> Ensure that formulas, data, and charts cannot be accidentally changed by the recipient.</li><li><strong>Browser-Based Security:</strong> Your spreadsheet never leaves your computer. The entire conversion process happens locally in your browser.</li></ul><h4>How to Convert Excel to PDF for Free</h4><ol><li><strong>Step 1: Upload Your Excel Sheet:</strong> Click the upload area or drag and drop your .xlsx file.</li><li><strong>Step 2: Automatic Conversion:</strong> The tool will automatically process the first sheet in your workbook.</li><li><strong>Step 3: Download the PDF:</strong> Your professional PDF document will be ready to download in seconds.</li></ol></div>
         <div id="article-jpg-to-pdf"><h3>Combine Images into a PDF</h3><p>Easily merge multiple images (JPG, PNG) into a single, convenient PDF file with our <strong>free Image to PDF converter</strong>. This tool is ideal for creating portfolios, archiving receipts, or compiling visual reports. It automatically formats all pages to a standard size for a professional look.</p><h4>Why Use an Image to PDF Converter?</h4><ul><li><strong>Easy to Share:</strong> Instead of sending multiple image files, send one organized PDF document.</li><li><strong>Portfolio Creation:</strong> A perfect way for photographers and designers to compile their work into one file.</li><li><strong>Private and Secure:</strong> Your images are processed directly in your browser and are never uploaded to our servers.</li></ul><h4>How to Combine Images into a PDF</h4><ol><li><strong>Step 1: Select Your Image Files:</strong> Drag and drop all the images you want to include into the upload area.</li><li><strong>Step 2: Arrange Your Images:</strong> Reorder the images by dragging and dropping them into your preferred sequence.</li><li><strong>Step 3: Convert and Download:</strong> Click the 'Convert' button to merge them into a single PDF, ready for immediate download.</li></ol></div>
         <div id="article-unlock-pdf"><h3>Remove PDF Password Security</h3><p>If you have a password-protected PDF that you no longer need to secure, our <strong>free Unlock PDF tool</strong> can remove the password protection. You must know the correct password to use this tool. Once unlocked, the file can be opened by anyone without requiring a password, making it easier to share or edit. The process is completely secure and browser-based.</p><h4>Why Unlock a PDF?</h4><ul><li><strong>Convenience:</strong> Remove the hassle of entering a password every time you or a trusted colleague needs to view the file.</li><li><strong>Improved Accessibility:</strong> Make the document easily accessible to a wider audience once it's no longer confidential.</li><li><strong>Client-Side Security:</strong> We do not see your password or your file. The unlocking process happens securely on your own computer.</li></ul><h4>How to Remove a PDF Password</h4><ol><li><strong>Step 1: Upload Your Locked PDF:</strong> Select the password-protected PDF you wish to unlock.</li><li><strong>Step 2: Enter the Current Password:</strong> In the options, provide the correct password for the document.</li><li><strong>Step 3: Unlock and Download:</strong> Click the 'Convert' button. The tool will remove the password and provide a link to download the unlocked PDF.</li></ol></div>
         <div id="article-rearrange-pages"><h3>Organize PDF by Rearranging Pages</h3><p>Take full control over your documents with our <strong>free Rearrange Pages tool</strong>. This utility allows you to change the order of pages within a PDF, delete unnecessary pages, and create a perfectly organized document. It's an essential tool for cleaning up reports, presentations, or any PDF file before sharing. All organization happens securely in your browser.</p><h4>Key Features</h4><ul><li><strong>Simple Page Reordering:</strong> Easily enter a new sequence for your pages.</li><li><strong>Secure and Fast:</strong> Your file is processed on your device, not on our servers, ensuring speed and total privacy.</li></ul><h4>How to Reorder PDF Pages</h4><ol><li><strong>Step 1: Upload Your PDF:</strong> Select the PDF file whose pages you want to organize.</li><li><strong>Step 2: Set New Page Order:</strong> In the options, enter the new sequence of pages (e.g., '3, 1, 5, 2, 4').</li><li><strong>Step 3: Reorganize and Download:</strong> Click the 'Convert' button. A new PDF with the reordered pages will be ready for you to download instantly.</li></ol></div>
         <div id="article-delete-pdf-pages"><h3>Easily Delete Pages from a PDF</h3><p>Our <strong>free Delete PDF Pages tool</strong> provides a quick and secure way to remove one or more pages from your PDF documents. Whether you need to remove blank pages, irrelevant information, or confidential sections before sharing a file, this tool makes the process effortless. The entire operation is performed in your browser, so your files remain private.</p><h4>Why Delete PDF Pages?</h4><ul><li><strong>Create Concise Documents:</strong> Remove unnecessary pages to make your document shorter and more focused.</li><li><strong>Protect Sensitive Information:</strong> Easily remove pages containing confidential data before distributing a document.</li><li><strong>Client-Side Privacy:</strong> Your PDF is never uploaded. The pages are removed right on your own computer.</li></ul><h4>How to Delete Pages from a PDF</h4><ol><li><strong>Step 1: Upload Your PDF Document:</strong> Drag and drop your file or select it from your device.</li><li><strong>Step 2: Specify Pages to Remove:</strong> In the tool options, enter the page numbers or ranges you want to delete (e.g., '2, 5-7').</li><li><strong>Step 3: Process and Download:</strong> Click the 'Convert' button. The tool will generate a new PDF without the specified pages, ready for download.</li></ol></div>
         <div id="article-watermark-pdf"><h3>Add a Watermark to Your PDF</h3><p>Protect your documents and assert ownership by adding a text watermark with our <strong>free Watermark PDF tool</strong>. This is perfect for marking files as "Confidential," "Draft," or adding your company's name to your work. The watermark is applied across every page, and the entire process is fast, free, and secure within your browser.</p><h4>Benefits of Adding a Watermark</h4><ul><li><strong>Assert Ownership:</strong> Clearly mark documents with your copyright or company name.</li><li><strong>Indicate Document Status:</strong> Use terms like "DRAFT" or "CONFIDENTIAL" to prevent misuse.</li><li><strong>Secure and Private:</strong> Your files are never uploaded. The watermark is applied locally on your computer.</li></ul><h4>How to Add a Watermark</h4><ol><li><strong>Step 1: Upload Your PDF:</strong> Select the document you wish to watermark.</li><li><strong>Step 2: Enter Watermark Text:</strong> In the options, type the text you want to use for the watermark.</li><li><strong>Step 3: Apply and Download:</strong> Click 'Convert'. Your watermarked PDF will be ready to download immediately.</li></ol></div>
         <div id="article-rotate-pdf"><h3>Rotate PDF Pages Free</h3><p>Correct the orientation of pages in your PDF with our simple and free <strong>Rotate PDF tool</strong>. Whether a page was scanned upside down or you need to switch between portrait and landscape, this tool provides a quick and secure solution directly in your browser.</p><h4>Key Features</h4><ul><li><strong>Flexible Rotation:</strong> Rotate pages 90 degrees clockwise, 90 degrees counter-clockwise (270), or 180 degrees.</li><li><strong>Selective Editing:</strong> Apply rotation to all pages at once or specify only the pages that need correcting (e.g., "2, 5-7").</li><li><strong>Secure and Private:</strong> All rotations happen locally on your device. Your file's content is never seen by us or any third party.</li></ul><h4>How to Rotate a PDF</h4><ol><li><strong>Step 1: Upload Your PDF:</strong> Drag and drop your file or click to select it from your device.</li><li><strong>Step 2: Choose Rotation Options:</strong> Select the angle of rotation and enter the page numbers you wish to modify. Leave the page field blank to rotate the entire document.</li><li><strong>Step 3: Apply and Download:</strong> Click the 'Convert' button. The tool will process your request instantly, and your newly rotated PDF will be ready for download.</li></ol></div>
         <div id="article-edit-pdf"><h3>Visually Edit Your PDF Online</h3><p>Our free <strong>Edit PDF tool</strong> provides a Paint-like interface to visually modify your PDF pages. Draw, annotate, or add text directly onto a preview of your document. It's the perfect way to fill out forms, add notes, or highlight sections before sharing. All editing is done securely in your browser.</p><h4>Key Features</h4><ul><li><strong>Freehand Drawing & Erasing:</strong> Use a brush tool with adjustable size and color to draw or erase anywhere on the page.</li><li><strong>Movable Text Tool:</strong> Add text with custom fonts and sizes, then use the 'Select' tool to drag it to the perfect spot.</li><li><strong>Visual and Intuitive:</strong> Edit your PDF just like you would edit an image, with an interactive canvas.</li></ul><h4>How to Edit a PDF</h4><ol><li><strong>Step 1: Upload Your PDF:</strong> Select the PDF file you want to edit. The first page will be loaded into the editor.</li><li><strong>Step 2: Edit the Page:</strong> Use the toolbar to select a tool (draw, text, erase, select), choose your color, font, and size, and make your changes on the canvas.</li><li><strong>Step 3: Save and Download:</strong> Click the 'Save & Download' button. The tool will apply your edits and provide a link to download the new, modified PDF.</li></ol></div>
      </div>
      <div id="ai-chat-responses" style="display:none">
         <div data-keywords="merge,combine,join">To combine files, our 'Merge PDF' tool is perfect. Just upload your PDFs, put them in order, and you're set!</div>
         <div data-keywords="split,extract,separate">Sounds like you need the 'Split PDF' tool. You can use it to pull out specific pages or ranges from your file in just a few clicks.</div>
         <div data-keywords="password,protect,secure,encrypt">Absolutely. To add a password, head over to the 'Protect PDF' tool. It’s a fast way to keep your file secure.</div>
         <div data-keywords="unlock,remove password">If you have a password-protected file, our 'Unlock PDF' tool can help. You will need to know the current password to remove it.</div>
         <div data-keywords="word,docx">Yep, you can use the 'Word to PDF' tool to convert DOCX files, or 'PDF to Word' to go the other way. Both are fast and secure.</div>
         <div data-keywords="jpg,image,png">We have two tools for that! Use 'Image to PDF' to combine images into one file, or 'PDF to Image' to turn a PDF page into a high-quality PNG image.</div>
         <div data-keywords="safe,privacy,upload,security">We take your privacy very seriously. All processing is done in your browser, so your files are never uploaded to any server. They stay with you.</div>
         <div data-keywords="why use,free">Our tools are designed to be fast, free, and completely private. Everything happens right in your browser, so your files are always secure and there are no hidden costs.</div>
         <div data-keywords="which tool,what tool,how to">I can definitely help with that! Could you tell me what you're trying to do? For example, are you trying to combine files, make a PDF smaller, or sign a document?</div>
         <div data-keywords="pdf to word">The 'PDF to Word' tool converts your PDF into an editable DOCX file, keeping your formatting intact.</div>
         <div data-keywords="pdf to jpg">The 'PDF to Image' tool turns each page of your PDF into a high-quality PNG image.</div>
         <div data-keywords="pdf to powerpoint">The 'PDF to PowerPoint' tool helps you convert PDFs into editable PPTX presentations.</div>
         <div data-keywords="pdf to excel">Use the 'PDF to Excel' tool to extract tables and data from your PDF into an XLSX spreadsheet.</div>
         <div data-keywords="word to pdf">The 'Word to PDF' tool creates a professional, non-editable PDF from your DOCX file.</div>
         <div data-keywords="jpg to pdf">Use 'Image to PDF' to combine multiple images into a single, easy-to-share PDF document.</div>
         <div data-keywords="powerpoint to pdf">Convert your PPTX presentations into a universal PDF format with the 'PowerPoint to PDF' tool.</div>
         <div data-keywords="html to pdf">The 'HTML to PDF' tool can convert a webpage or an HTML file into a PDF document.</div>
         <div data-keywords="excel to pdf">Use the 'Excel to PDF' tool to convert your spreadsheets into a clean, professional PDF.</div>
         <div data-keywords="compress pdf">The 'Compress PDF' tool reduces your PDF's file size, making it easier to share.</div>
         <div data-keywords="delete pages">With the 'Delete Pages' tool, you can easily remove specific pages from your PDF file.</div>
         <div data-keywords="rotate pdf">The 'Rotate PDF' tool allows you to correct the orientation of pages in your document.</div>
         <div data-keywords="ocr pdf">Use 'OCR PDF' to extract text from scanned documents, making the content editable.</div>
         <div data-keywords="searchable pdf">The 'Searchable PDF' tool converts a scanned PDF into a text-searchable document.</div>
         <div data-keywords="pdf to text">The 'PDF to Text' tool extracts all the plain text from your PDF file.</div>
         <div data-keywords="rearrange pages">You can change the order of pages in your document using the 'Rearrange Pages' tool.</div>
         <div data-keywords="add page numbers">The 'Add Page Numbers' tool lets you easily insert page numbers into your PDF.</div>
         <div data-keywords="edit pdf,annotate">The 'Edit PDF' tool gives you a canvas to draw, erase, and add movable text directly onto your PDF page.</div>
         <div data-keywords="esign,sign">You can sign your documents electronically using the 'eSign PDF' tool.</div>
         <div data-keywords="watermark">The 'Watermark PDF' tool lets you add a text watermark (like 'Confidential') to every page.</div>
         <div data-keywords="repair pdf">If you have a corrupted file, the 'Repair PDF' tool can attempt to fix it.</div>
         <div data-keywords="edit metadata">The 'Edit Metadata' tool allows you to change the author, title, and other properties of your PDF.</div>
         <div data-keywords="hello,hi,hey">Hi there! What can I help you with today?</div>
         <div data-keywords="help,support">Of course! Just let me know what you need to do, and I'll point you to the right tool.</div>
         <div data-keywords="thanks,thank you">You're welcome! Let me know if there's anything else I can help with.</div>
         <div data-keywords="default">I can help you find the right tool. For other questions, you can always reach our team directly at alltoolpdf@gmail.com.</div>
      </div>
      <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script><script src="https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.min.js"></script><script src="https://unpkg.com/tesseract.js@5/dist/tesseract.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script><script src="https://unpkg.com/mammoth@1.6.0/mammoth.browser.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
      <script>
         document.addEventListener('DOMContentLoaded', () => {
             const { PDFDocument, rgb, degrees, StandardFonts, PageSizes } = PDFLib;
             pdfjsLib.GlobalWorkerOptions.workerSrc = `https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.worker.min.js`;
         
             const mainPageHeader = document.querySelector('#main-page .header .navbar .logo');
             const toolModal = document.getElementById('tool-modal');
             const staticModal = document.getElementById('static-modal-template');
             const loader = document.getElementById('loader-container');
             const loaderText = document.getElementById('loader-text');
             const processBtn = document.getElementById('process-btn');
             const outputArea = document.getElementById('output-area');
             const editorContainer = document.getElementById('pdf-editor-container');
             const deletePagesViewer = document.getElementById('delete-pages-viewer');
             let selectedFiles = [];

             let currentPdfForDelete = null;
             let mainViewZoom = 1.0;
             let activePageNum = 1;
             let originalFileBuffer = null;
             let currentFileBuffer = null;
             let currentDeleteMode = 'delete';
             
             let editorInstance = null;
             let currentPdfDoc = null;
             let currentPageNum = 1;
             let allPageEdits = new Map();
         
             const showError = (message) => { hideLoader(); alert(`Error: ${message}`); };
             const showLoader = (text = 'Processing...') => { loaderText.textContent = text; loader.style.display = 'flex'; };
             const hideLoader = () => loader.style.display = 'none';
             const readFileAsArrayBuffer = (file) => new Promise((resolve, reject) => { const reader = new FileReader(); reader.onload = () => resolve(reader.result); reader.onerror = reject; reader.readAsArrayBuffer(file); });
             
             const displayDownloadLink = (blob, fileName) => {
                const container = document.createElement('div');
                container.className = 'download-container';
                const text = document.createElement('p');
                text.textContent = `Your file is ready: ${fileName}`;
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = fileName;
                link.textContent = 'Download';
                link.className = 'download-link';
                container.appendChild(text);
                container.appendChild(link);
                outputArea.appendChild(container);
             };

             const generateOutputFilename = (originalFile, suffix, newExtension) => {
                if (!originalFile) return `${suffix}.${newExtension || 'pdf'}`;
                const nameWithoutExtension = originalFile.name.lastIndexOf('.') > -1 ? originalFile.name.substring(0, originalFile.name.lastIndexOf('.')) : originalFile.name;
                return `${nameWithoutExtension}_${suffix}.${newExtension || 'pdf'}`;
             };
             const parsePageRanges = (rangeStr, maxPage) => {
                const indices = new Set();
                if (!rangeStr.trim()) return Array.from({length: maxPage}, (_, i) => i);
                const parts = rangeStr.replace(/\s/g, '').split(',');
                for (const part of parts) {
                    if (part.includes('-')) {
                        let [start, end] = part.split('-').map(Number);
                        if (!isNaN(start) && !isNaN(end) && start <= end) { for (let i = start; i <= end; i++) if(i>0 && i<=maxPage) indices.add(i - 1); }
                    } else {
                        const pageNum = Number(part);
                        if (!isNaN(pageNum) && pageNum > 0 && pageNum <= maxPage) indices.add(pageNum - 1);
                    }
                }
                return Array.from(indices).sort((a,b) => a-b);
             };
             const advancedToolComingSoon = () => showError('This advanced conversion tool will be available in a future version.');
             
            const processWithBackend = async (files, toolEndpoint) => {
                const file = files[0];
                const formData = new FormData();
                formData.append('file', file);
            
                // Assuming your Flask app is running locally on port 10000.
                // CHANGE THIS URL IF YOU DEPLOY YOUR BACKEND SOMEWHERE ELSE.
                const backendUrl = `http://127.0.0.1:10000/${toolEndpoint}`;
            
                try {
                    showLoader('Processing with high-quality server...');
                    const response = await fetch(backendUrl, {
                        method: 'POST',
                        body: formData,
                    });
            
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({ error: 'An unknown server error occurred.' }));
                        throw new Error(errorData.error || `Server error: ${response.status}`);
                    }
            
                    const blob = await response.blob();
                    
                    let finalFileName = "converted_file";
                    const contentDisposition = response.headers.get('content-disposition');
                    if (contentDisposition) {
                        const match = contentDisposition.match(/filename="?([^"]+)"?/i);
                        if (match && match.length > 1) finalFileName = match[1];
                    }
                    
                    outputArea.innerHTML = '';
                    displayDownloadLink(blob, finalFileName);

                } catch (err) {
                    showError(`Failed to process the file. The server may be down or unable to convert this specific file. Details: ${err.message}`);
                } finally {
                    hideLoader();
                    processBtn.style.display = 'none';
                }
            };
         
             const setupPdfEditor = () => {
                const canvas = document.getElementById('pdf-canvas');
                const ctx = canvas.getContext('2d');
                const fontControls = document.getElementById('font-style-buttons').parentElement.parentElement;
                const shapeControls = document.getElementById('fill-shape-check').parentElement;
                const universalSizeInput = document.getElementById('universal-size');
                const selectedColorView = document.getElementById('selected-color-view');
                const colorGrid = document.getElementById('color-grid');
                const colorPicker = document.getElementById('color-picker');
                const fontFamilySelect = document.getElementById('font-family');
                const textEditor = document.getElementById('text-editor-input');
                const boldBtn = document.getElementById('bold-btn');
                const italicBtn = document.getElementById('italic-btn');
                const underlineBtn = document.getElementById('underline-btn');
                
                let currentTool = 'text';
                let currentColor = '#000000';
                let currentFontSize = 48;
                let currentToolSize = 12;
                let drawingActions = [];
                let isPainting = false;
                let isDragging = false;
                let selectedActionIndex = -1;
                let dragOffsetX, dragOffsetY, startX, startY;
                const bgCanvas = document.createElement('canvas');
         
                if(colorGrid.childElementCount === 0) {
                    const colors = [
                        '#000000', '#696969', '#8b0000', '#ff0000', '#ffa500', '#ffff00', '#008000', '#00ced1', '#0000ff', '#4b0082',
                        '#ffffff', '#d3d3d3', '#f08080', '#ffc0cb', '#ffe4b5', '#fafad2', '#90ee90', '#afeeee', '#add8e6', '#dda0dd'
                    ];
                    colors.forEach(color => {
                        const colorBox = document.createElement('div');
                        colorBox.className = 'color-box';
                        colorBox.style.backgroundColor = color;
                        colorBox.dataset.color = color;
                        if(color === '#ffffff') colorBox.style.border = '1px solid #ddd';
                        colorGrid.appendChild(colorBox);
                    });
                }
                
                const setInitialBackground = () => {
                    bgCanvas.width = canvas.width; bgCanvas.height = canvas.height;
                    bgCanvas.getContext('2d').drawImage(canvas, 0, 0);
                };
         
                const getFontString = (action) => `${action.italic ? 'italic ' : ''}${action.bold ? 'bold ' : ''}${action.size}px ${action.font}`;
         
                const updateToolbarState = () => {
                     const isTextRelated = currentTool === 'text' || (currentTool === 'select' && selectedActionIndex !== -1 && drawingActions[selectedActionIndex]?.type === 'text');
                     fontControls.querySelector('select').disabled = !isTextRelated;
                     fontControls.querySelector('.font-style-buttons').style.opacity = isTextRelated ? 1 : 0.5;
                     fontControls.querySelector('.font-style-buttons').style.pointerEvents = isTextRelated ? 'auto' : 'none';
                     shapeControls.querySelector('input').disabled = ['select', 'text'].includes(currentTool);
                     if (isTextRelated) {
                         universalSizeInput.value = currentFontSize;
                         if (selectedActionIndex > -1) {
                             const action = drawingActions[selectedActionIndex];
                             universalSizeInput.value = action.size;
                             fontFamilySelect.value = action.font;
                             boldBtn.classList.toggle('active', !!action.bold);
                             italicBtn.classList.toggle('active', !!action.italic);
                             underlineBtn.classList.toggle('active', !!action.underline);
                             setColor(action.color);
                         }
                     } else {
                         universalSizeInput.value = currentToolSize;
                     }
                 };
                
                const redraw = (withPreview = true) => {
                    if (!canvas.width || !canvas.height) return;
                    ctx.clearRect(0, 0, canvas.width, canvas.height); 
                    ctx.drawImage(bgCanvas, 0, 0);
                    
                    drawingActions.forEach((action, index) => {
                        Object.assign(ctx, { 
                            fillStyle: action.color, 
                            strokeStyle: action.color, 
                            lineWidth: action.size, 
                            lineCap: 'round', 
                            lineJoin: 'round' 
                        });
                        
                        if (action.type === 'path') {
                            ctx.beginPath();
                            if(action.points.length > 0){ 
                                ctx.moveTo(action.points[0].x, action.points[0].y); 
                                action.points.slice(1).forEach(p => ctx.lineTo(p.x, p.y)); 
                                ctx.stroke(); 
                            }
                        } else if (action.type === 'text') {
                            ctx.font = getFontString(action); 
                            ctx.textAlign = 'left'; 
                            ctx.textBaseline = 'top'; 
                            ctx.fillText(action.text, action.x, action.y);
                            if (action.underline) {
                                const textWidth = ctx.measureText(action.text).width;
                                Object.assign(ctx, {lineWidth: Math.max(1, Math.floor(action.size / 15)) });
                                ctx.beginPath();
                                ctx.moveTo(action.x, action.y + parseInt(action.size, 10) + 2); 
                                ctx.lineTo(action.x + textWidth, action.y + parseInt(action.size, 10) + 2);
                                ctx.stroke();
                            }
                        } else if (['line', 'rectangle', 'circle'].includes(action.type)) {
                            ctx.beginPath();
                            if (action.type === 'line') { 
                                ctx.moveTo(action.startX, action.startY); 
                                ctx.lineTo(action.endX, action.endY); 
                            } else if (action.type === 'rectangle') { 
                                ctx.rect(action.startX, action.startY, action.endX - action.startX, action.endY - action.startY); 
                            } else if (action.type === 'circle') { 
                                const radiusX = Math.abs(action.endX - action.startX) / 2; 
                                const radiusY = Math.abs(action.endY - action.startY) / 2;
                                const centerX = action.startX + (action.endX - action.startX) / 2;
                                const centerY = action.startY + (action.endY - action.startY) / 2;
                                ctx.ellipse(centerX, centerY, radiusX, radiusY, 0, 0, 2 * Math.PI); 
                            }
                           action.fill ? ctx.fill() : ctx.stroke();
                        }
         
                        if (withPreview && index === selectedActionIndex && action.type === 'text') {
                           Object.assign(ctx, {strokeStyle: 'rgba(0, 100, 255, 0.7)', lineWidth: 1});
                           ctx.setLineDash([4, 2]); 
                           const textWidth = ctx.measureText(action.text).width;
                           ctx.strokeRect(action.x - 3, action.y - 3, textWidth + 6, parseInt(action.size, 10) + 6);
                           ctx.setLineDash([]);
                        }
                    });
                };
         
                const getMousePos = (e) => ({ x: (e.clientX - canvas.getBoundingClientRect().left) * (canvas.width / canvas.getBoundingClientRect().width), y: (e.clientY - canvas.getBoundingClientRect().top) * (canvas.height / canvas.getBoundingClientRect().height) });
                
                const hitTest = (x, y) => { 
                    for (let i = drawingActions.length - 1; i >= 0; i--) { 
                        const action = drawingActions[i]; 
                        if (action.type === 'text') { 
                            ctx.font = getFontString(action); 
                            if (x >= action.x && x <= action.x + ctx.measureText(action.text).width && y >= action.y && y <= action.y + parseInt(action.size, 10)) return i; 
                        } 
                    } 
                    return -1; 
                };
         
                const finalizeText = () => {
                    if (textEditor.style.display === 'none') return;
                    const newText = textEditor.value.trim();
                    if (newText) {
                        drawingActions.push({
                            type: 'text', text: newText,
                            x: parseFloat(textEditor.dataset.x), y: parseFloat(textEditor.dataset.y), font: fontFamilySelect.value, size: currentFontSize, color: currentColor,
                            bold: boldBtn.classList.contains('active'), italic: italicBtn.classList.contains('active'), underline: underlineBtn.classList.contains('active'),
                        });
                    }
                    textEditor.style.display = 'none'; 
                    redraw();
                    document.getElementById('select-tool-btn').click();
                };
         
                const startTextEditing = (x, y, editIndex = -1) => {
                    finalizeText();
                    let action = null; 
                    let initialText = "Type Here";
                    if (editIndex > -1) { 
                        action = drawingActions[editIndex]; 
                        initialText = action.text; 
                        drawingActions.splice(editIndex, 1); 
                        redraw(); 
                    }
                    const rect = canvas.getBoundingClientRect();
                    Object.assign(textEditor.style, { display: 'block', left: `${(x * (rect.width/canvas.width)) + rect.left}px`, top: `${(y * (rect.height/canvas.height)) + rect.top}px` });
                    Object.assign(textEditor.dataset, { x, y }); 
                    textEditor.value = initialText;
                    
                    const style = { 
                        font: action?.font || fontFamilySelect.value, 
                        size: action?.size || currentFontSize, 
                        color: action?.color || currentColor, 
                        bold: action?.bold, 
                        italic: action?.italic, 
                        underline: action?.underline 
                    };
                    Object.assign(textEditor.style, { fontFamily: style.font, fontSize: style.size + 'px', color: style.color, fontWeight: style.bold ? 'bold' : 'normal', fontStyle: style.italic ? 'italic' : 'normal' });
                    
                    ctx.font = getFontString(style);
                    textEditor.style.width = `${ctx.measureText(initialText).width + 20}px`;
                    textEditor.focus(); 
                    textEditor.select();
         
                    fontFamilySelect.value = style.font; 
                    universalSizeInput.value = style.size;
                    currentFontSize = style.size;
                    boldBtn.classList.toggle('active', !!style.bold); 
                    italicBtn.classList.toggle('active', !!style.italic); 
                    underlineBtn.classList.toggle('active', !!style.underline);
                    setColor(style.color); 
                    updateToolbarState();
                };
         
                const setColor = (color) => { 
                    currentColor = color; 
                    selectedColorView.style.backgroundColor = color; 
                    colorPicker.value = color;
                    if(textEditor.style.display === 'block') textEditor.style.color = color;
                };
                
                document.getElementById('toolbar-top-row').addEventListener('click', e => {
                    const button = e.target.closest('button');
                    if (button && button.id.includes('-tool-btn')) {
                        finalizeText();
                        document.querySelectorAll('#toolbar-top-row button').forEach(b => b.classList.remove('active'));
                        button.classList.add('active'); 
                        currentTool = button.id.replace('-tool-btn', '');
                        canvas.style.cursor = currentTool === 'select' ? 'default' : (currentTool === 'text' ? 'text' : 'crosshair');
                        selectedActionIndex = -1; 
                        redraw(); 
                        updateToolbarState();
                    }
                });
                
                universalSizeInput.addEventListener('input', () => {
                     const size = universalSizeInput.value;
                     if(currentTool === 'text' || (currentTool === 'select' && selectedActionIndex > -1)){
                         currentFontSize = size;
                         if(selectedActionIndex > -1 && drawingActions[selectedActionIndex].type === 'text') {
                             drawingActions[selectedActionIndex].size = size;
                             redraw();
                         }
                     } else {
                         currentToolSize = size;
                     }
                });

                [fontFamilySelect, colorPicker].forEach(el => el.addEventListener('input', () => {
                    setColor(colorPicker.value);
                    const isEditing = textEditor.style.display !== 'none';
                    const targetAction = isEditing ? null : (selectedActionIndex > -1 ? drawingActions[selectedActionIndex] : null);
                    if (targetAction?.type === 'text') { 
                         targetAction.font = fontFamilySelect.value;
                         targetAction.color = currentColor;
                         redraw(); 
                    }
                }));
         
                [boldBtn, italicBtn, underlineBtn].forEach(btn => btn.addEventListener('click', () => {
                    const isTextRelated = currentTool === 'text' || (currentTool === 'select' && selectedActionIndex > -1);
                    if (!isTextRelated) return;
                    btn.classList.toggle('active');
                    const targetAction = selectedActionIndex > -1 ? drawingActions[selectedActionIndex] : null;
                    if (targetAction?.type === 'text') {
                        const styleProp = btn.id.replace('-btn', '');
                        targetAction[styleProp] = btn.classList.contains('active');
                        redraw();
                    }
                }));
                
                colorGrid.addEventListener('click', (e) => { if (e.target.classList.contains('color-box')) setColor(e.target.dataset.color) });
                selectedColorView.addEventListener('click', () => colorPicker.click());
                
                canvas.addEventListener('mousedown', e => {
                    if (e.target === textEditor) return; 
                    finalizeText(); 
                    const { x, y } = getMousePos(e); 
                    startX = x; 
                    startY = y;
                    
                    if (currentTool === 'select') {
                        isPainting = false; 
                        selectedActionIndex = hitTest(x, y);
                        if (selectedActionIndex > -1) { 
                            isDragging = true; 
                            const action = drawingActions[selectedActionIndex]; 
                            dragOffsetX = x - action.x; 
                            dragOffsetY = y - action.y; 
                        } else {
                            isDragging = false;
                        }
                        redraw(); 
                        updateToolbarState();
                    } else {
                         isPainting = true;
                         const size = ['draw', 'erase', 'line', 'rectangle', 'circle'].includes(currentTool) ? currentToolSize : currentFontSize;
                         if (currentTool === 'draw' || currentTool === 'erase') {
                             drawingActions.push({ type: 'path', color: currentTool === 'erase' ? '#FFFFFF' : currentColor, size, points: [{ x, y }] });
                         }
                    }
                });
                
                canvas.addEventListener('mousemove', e => {
                    if (!isPainting && !isDragging) return; 
                    const { x, y } = getMousePos(e);
                    
                    if (isDragging && selectedActionIndex > -1) { 
                        drawingActions[selectedActionIndex].x = x - dragOffsetX; 
                        drawingActions[selectedActionIndex].y = y - dragOffsetY; 
                        redraw();
                    } else if (isPainting) {
                        const size = currentToolSize;
                        if (['draw', 'erase'].includes(currentTool)) {
                            drawingActions[drawingActions.length - 1].points.push({ x, y });
                        }
                        redraw(); 
                        Object.assign(ctx, {strokeStyle:currentColor, fillStyle:currentColor, lineWidth:size});
                        if (['line', 'rectangle', 'circle'].includes(currentTool)) {
                            ctx.beginPath();
                            if (currentTool === 'line') { 
                                ctx.moveTo(startX, startY); ctx.lineTo(x, y); 
                            } else if (currentTool === 'rectangle') { 
                                ctx.rect(startX, startY, x - startX, y - startY); 
                            } else if (currentTool === 'circle') { 
                                const rX = Math.abs(x - startX) / 2, rY = Math.abs(y - startY) / 2;
                                const cX = startX + (x - startX)/2, cY = startY + (y - startY)/2;
                                ctx.ellipse(cX, cY, rX, rY, 0, 0, 2*Math.PI); 
                            }
                            document.getElementById('fill-shape-check').checked ? ctx.fill() : ctx.stroke();
                        }
                    }
                });
         
                canvas.addEventListener('mouseup', e => { 
                    if (!isPainting) { isDragging = false; return; }
                    isPainting = false; 
                    const { x, y } = getMousePos(e);
                     const size = ['draw', 'erase', 'line', 'rectangle', 'circle'].includes(currentTool) ? currentToolSize : currentFontSize;
                    if (['line', 'rectangle', 'circle'].includes(currentTool)) {
                        drawingActions.push({ type: currentTool, color: currentColor, size, fill: document.getElementById('fill-shape-check').checked, startX, startY, endX: x, endY: y });
                    }
                    redraw();
                });
                
                canvas.addEventListener('click', e => { 
                    if(currentTool === 'text') { 
                        const { x, y } = getMousePos(e); 
                        startTextEditing(x, y); 
                    } 
                });
                canvas.addEventListener('dblclick', e => { 
                    if (currentTool === 'select' && selectedActionIndex > -1 && drawingActions[selectedActionIndex].type === 'text') { 
                        const action = drawingActions[selectedActionIndex]; 
                        startTextEditing(action.x, action.y, selectedActionIndex); 
                        selectedActionIndex = -1; 
                    } 
                });
         
                textEditor.addEventListener('input', () => {
                    ctx.font = getFontString({ font: textEditor.style.fontFamily, size: currentFontSize, bold: textEditor.style.fontWeight === 'bold', italic: textEditor.style.fontStyle === 'italic' });
                    textEditor.style.width = `${ctx.measureText(textEditor.value).width + 20}px`;
                });
                textEditor.addEventListener('keydown', e => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); finalizeText(); } });
                textEditor.addEventListener('mousedown', e => { isDragging = true; dragOffsetX = e.clientX - textEditor.offsetLeft; dragOffsetY = e.clientY - textEditor.offsetTop; e.stopPropagation(); });
                
                document.body.addEventListener('mousemove', e => {
                    if (isDragging && textEditor.style.display === 'block') {
                        const newLeft = e.clientX - dragOffsetX, newTop = e.clientY - dragOffsetY;
                        textEditor.style.left = `${newLeft}px`; 
                        textEditor.style.top = `${newTop}px`;
                        const rect = canvas.getBoundingClientRect();
                        textEditor.dataset.x = (newLeft - rect.left) * (canvas.width / rect.width);
                        textEditor.dataset.y = (newTop - rect.top) * (canvas.height / rect.height);
                    }
                });
                document.body.addEventListener('mouseup', () => { isDragging = false; });
         
                 return {
                     setInitialBackground,
                     getDrawingActions: () => drawingActions,
                     setDrawingActions: (actions) => { drawingActions = actions; },
                     redraw,
                     updateToolbarState,
                     finalizeText,
                 };
             };
             
            const toolImplementations = {
                'pdf-to-word': { title: 'PDF to Word', desc: 'Convert PDFs to editable DOCX.', fileType: '.pdf', multiple: false, process: (files) => processWithBackend(files, 'pdf-to-word') },
                'word-to-pdf': { title: 'Word to PDF', desc: 'Create professional PDFs from Word.', fileType: '.docx,.doc,.rtf', multiple: false, process: (files) => processWithBackend(files, 'word-to-pdf') },
                'pdf-to-excel': { title: 'PDF to Excel', desc: 'Extract data from PDFs into XLSX.', fileType: '.pdf', multiple: false, process: (files) => processWithBackend(files, 'pdf-to-excel') },
                'excel-to-pdf': { title: 'Excel to PDF', desc: 'Turn spreadsheets into professional PDFs.', fileType: '.xlsx,.xls,.csv', multiple: false, process: (files) => processWithBackend(files, 'excel-to-pdf') },
                'add-page-numbers': { 
                   title: 'Add Page Numbers', 
                   desc: 'Insert page numbers into your PDF.', 
                   fileType: '.pdf', 
                   multiple: false, 
                   options: () => `<div style="display: flex; gap: 20px; align-items: flex-end;"><div style="flex-grow: 1;"><label for="vertical-pos">Position:</label><select id="vertical-pos"><option value="footer" selected>Footer (Bottom of page)</option><option value="header">Header (Top of page)</option></select></div><div style="flex-grow: 1;"><label for="horizontal-align">Alignment:</label><select id="horizontal-align"><option value="center" selected>Center</option><option value="left">Left</option><option value="right">Right</option></select></div></div>`,
                   process: async (files, options) => {
                       showLoader('Adding page numbers...');
                       const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { ignoreEncryption: true });
                       const font = await pdfDoc.embedFont(StandardFonts.Helvetica);
                       const pages = pdfDoc.getPages();
                       for(let i=0; i<pages.length; i++) {
                           const page = pages[i];
                           const { width, height } = page.getSize();
                           const text = `${i+1} / ${pages.length}`;
                           const textWidth = font.widthOfTextAtSize(text, 12);
                           const y = (options['vertical-pos'] === 'header') ? height - 40 : 30;
                           let x;
                           if (options['horizontal-align'] === 'left') x = 40;
                           else if (options['horizontal-align'] === 'right') x = width - textWidth - 40;
                           else x = width / 2 - textWidth / 2;
                           page.drawText(text, { x, y, size: 12, font, color: rgb(0, 0, 0) });
                       }
                       displayDownloadLink(new Blob([await pdfDoc.save()], {type: 'application/pdf'}), generateOutputFilename(files[0], 'numbered'));
                   } 
                },
                 'delete-pdf-pages': { title: 'Delete Pages', desc: 'Remove pages from a PDF.', fileType: '.pdf', multiple: false, isVisualDeleter: true },
                 'edit-pdf': { title: 'Edit PDF', desc: 'Draw and add text to your PDF.', fileType: '.pdf', multiple: false, isEditor: true },
                 'merge-pdf': { title: 'Merge PDF', desc: 'Combine multiple PDFs into one.', fileType: '.pdf', multiple: true, process: async (files) => { const mergedPdf = await PDFDocument.create(); for (let i = 0; i < files.length; i++) { showLoader(`Merging file ${i+1}/${files.length}...`); const pdf = await PDFDocument.load(await readFileAsArrayBuffer(files[i]), { ignoreEncryption: true }); const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices()); copiedPages.forEach(page => mergedPdf.addPage(page)); } displayDownloadLink(new Blob([await mergedPdf.save()], { type: 'application/pdf' }), generateOutputFilename(null, 'merged')); } },
                 'split-pdf': { title: 'Split PDF', desc: 'Extract pages into a new PDF.', fileType: '.pdf', multiple: false, options: () => `<label for="page-range">Page range to extract (e.g., 2-5, 8):</label><input type="text" id="page-range" placeholder="e.g., 2-5, 8, 10-12">`, process: async (files, options) => { if (!options['page-range']) throw new Error('Page range is required.'); const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { ignoreEncryption: true }); const pageIndices = parsePageRanges(options['page-range'], pdfDoc.getPageCount()); if (pageIndices.length === 0) throw new Error("Invalid page range specified."); const newPdf = await PDFDocument.create(); showLoader(`Copying ${pageIndices.length} pages...`); const copiedPages = await newPdf.copyPages(pdfDoc, pageIndices); copiedPages.forEach(page => newPdf.addPage(page)); displayDownloadLink(new Blob([await newPdf.save()], { type: 'application/pdf' }), generateOutputFilename(files[0], 'split')); } },
                 'rearrange-pages': { title: 'Rearrange Pages', desc: 'Sort or reorder PDF pages.', fileType: '.pdf', multiple: false, options: () => `<label for="page-order">New page order (e.g., 3,1,5-7):</label><input type="text" id="page-order" placeholder="e.g., 3, 1, 5-7, 2">`, process: async(files, options) => { if(!options['page-order']) throw new Error("New page order is required."); const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { ignoreEncryption: true }); const pageIndices = parsePageRanges(options['page-order'], pdfDoc.getPageCount()); if (pageIndices.length === 0) throw new Error("Invalid page order specified."); const newPdf = await PDFDocument.create(); showLoader(`Copying ${pageIndices.length} pages...`); const copiedPages = await newPdf.copyPages(pdfDoc, pageIndices); copiedPages.forEach(page => newPdf.addPage(page)); displayDownloadLink(new Blob([await newPdf.save()], {type: 'application/pdf'}), generateOutputFilename(files[0], 'rearranged')); } },
                 'pdf-to-powerpoint': { title: 'PDF to PowerPoint', desc: 'Turn PDFs into editable PPTX.', fileType: '.pdf', multiple: false, process: advancedToolComingSoon },
                 'powerpoint-to-pdf': { title: 'PowerPoint to PDF', desc: 'Convert PPTX into shareable PDFs.', fileType: '.pptx,.ppt', multiple: false, process: (files) => processWithBackend(files, 'powerpoint-to-pdf') },
                 'pdf-to-jpg': { 
                    title: 'PDF to Image (PNG)', 
                    desc: 'Extract pages as high-quality PNG images.', 
                    fileType: '.pdf', 
                    multiple: false, 
                    process: async (files) => { 
                        outputArea.innerHTML = '';
                        const pdfDoc = await pdfjsLib.getDocument({ data: await readFileAsArrayBuffer(files[0]) }).promise; 
                        for (let i = 1; i <= pdfDoc.numPages; i++) { 
                            showLoader(`Converting page ${i} of ${pdfDoc.numPages}...`); 
                            const page = await pdfDoc.getPage(i); 
                            const viewport = page.getViewport({ scale: 3.0 }); 
                            const canvas = document.createElement('canvas'); 
                            canvas.height = viewport.height; 
                            canvas.width = viewport.width; 
                            await page.render({ canvasContext: canvas.getContext('2d'), viewport }).promise; 
                            const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png')); 
                            displayDownloadLink(blob, generateOutputFilename(files[0], 'page_'+i, 'png')); 
                        } 
                    } 
                 },
                 'jpg-to-pdf': { 
                     title: 'Image to PDF', 
                     desc: 'Combine images (JPG, PNG) into a PDF.', 
                     fileType: 'image/jpeg,image/png', 
                     multiple: true, 
                     process: async (files) => { 
                         const pdfDoc = await PDFDocument.create(); 
                         const A4_PAGE_SIZE = PageSizes.A4; 
                         const [pageWidth, pageHeight] = A4_PAGE_SIZE;
                         for (let i = 0; i < files.length; i++) { 
                             showLoader(`Adding image ${i + 1} of ${files.length}...`); 
                             const imageBytes = await readFileAsArrayBuffer(files[i]); 
                             const image = files[i].type === 'image/jpeg' ? await pdfDoc.embedJpg(imageBytes) : await pdfDoc.embedPng(imageBytes); 
                             const page = pdfDoc.addPage(A4_PAGE_SIZE);
                             const scale = Math.min(pageWidth / image.width, pageHeight / image.height);
                             const scaledWidth = image.width * scale;
                             const scaledHeight = image.height * scale;
                             const x = (pageWidth - scaledWidth) / 2;
                             const y = (pageHeight - scaledHeight) / 2;
                             page.drawImage(image, { x: x, y: y, width: scaledWidth, height: scaledHeight }); 
                         } 
                         displayDownloadLink(new Blob([await pdfDoc.save()], { type: 'application/pdf' }), generateOutputFilename(null, 'combined_images')); 
                     } 
                 },
                 'html-to-pdf': { title: 'HTML to PDF', desc: 'Convert web pages or HTML into PDF.', fileType: '.html', multiple: false, process: async (files) => { const reader = new FileReader(); reader.onload = async (e) => { showLoader('Generating High-Quality PDF...'); const options = { margin: 0.5, filename: 'file.pdf', image: { type: 'jpeg', quality: 1 }, html2canvas: { scale: 4 }, jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' } }; const pdfBlob = await html2pdf().from(e.target.result).set(options).outputPdf('blob'); displayDownloadLink(pdfBlob, generateOutputFilename(files[0], 'from_html')); }; reader.readAsText(files[0]); } },
                 'compress-pdf': { title: 'Compress PDF', desc: 'Reduce file size of your PDF.', fileType: '.pdf', multiple: false, process: async (files) => { showLoader('Applying basic compression...'); const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { ignoreEncryption: true }); displayDownloadLink(new Blob([await pdfDoc.save({ useObjectStreams: false })], { type: 'application/pdf' }), generateOutputFilename(files[0], 'compressed')); } },
                 'rotate-pdf': { title: 'Rotate PDF', desc: 'Rotate pages in your PDF.', fileType: '.pdf', multiple: false, options: () => `<label for="rotation-angle">Rotation:</label><select id="rotation-angle"><option value="90">90° clockwise</option><option value="180">180°</option><option value="270">90° counter-clockwise</option></select><label for="page-range-rotate">Pages (blank for all):</label><input type="text" id="page-range-rotate" placeholder="e.g., 1, 3, 5-7">`, process: async(files, options) => { const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { ignoreEncryption: true }); const pagesToRotate = parsePageRanges(options['page-range-rotate'], pdfDoc.getPageCount()); showLoader(`Rotating ${pagesToRotate.length} pages...`); pagesToRotate.forEach(index => { const page = pdfDoc.getPage(index); page.setRotation(degrees(page.getRotation().angle + parseInt(options['rotation-angle'], 10))); }); displayDownloadLink(new Blob([await pdfDoc.save()], {type: 'application/pdf'}), generateOutputFilename(files[0], 'rotated')); } },
                 'protect-pdf': { title: 'Protect PDF', desc: 'Secure PDF with a password.', fileType: '.pdf', multiple: false, options: () => `<label for="pdf-password">Set Password:</label><input type="password" id="pdf-password" placeholder="Enter a strong password">`, process: async (files, options) => { if (!options['pdf-password']) throw new Error('Password is required.'); showLoader('Encrypting PDF...'); const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { ignoreEncryption: true }); displayDownloadLink(new Blob([await pdfDoc.save({ userPassword: options['pdf-password'] })], { type: 'application/pdf' }), generateOutputFilename(files[0], 'protected')); } },
                 'unlock-pdf': { title: 'Unlock PDF', desc: 'Remove password from a PDF.', fileType: '.pdf', multiple: false, options: () => `<label for="pdf-password-unlock">Current Password:</label><input type="password" id="pdf-password-unlock" placeholder="Enter the current password">`, process: async (files, options) => { if (!options['pdf-password-unlock']) throw new Error('Current password is required.'); showLoader('Attempting to unlock PDF...'); const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { userPassword: options['pdf-password-unlock'] }); displayDownloadLink(new Blob([await newPdf.save()], {type: 'application/pdf'}), generateOutputFilename(files[0], 'unlocked')); } },
                 'ocr-pdf': { title: 'OCR PDF', desc: 'Extract text from a scanned PDF.', fileType: '.pdf,image/*', multiple: false, process: async(files) => { showLoader("Initializing OCR Engine..."); const worker = await Tesseract.createWorker('eng', 1, { logger: m => { if(m.status === 'recognizing text') showLoader(`Recognizing Text: ${Math.round(m.progress * 100)}%`) }}); const { data: { text } } = await worker.recognize(files[0]); await worker.terminate(); displayDownloadLink(new Blob([text], { type: 'text/plain' }), generateOutputFilename(files[0], 'ocr', 'txt')); } },
                 'searchable-pdf': { title: 'Searchable PDF', desc: 'Make a scanned PDF searchable.', fileType: '.pdf', multiple: false, process: async (files) => { showLoader("Initializing OCR... (This may be slow)"); const worker = await Tesseract.createWorker('eng', 1, { logger: m => showLoader(`${m.status.charAt(0).toUpperCase() + m.status.slice(1)}: ${Math.round(m.progress * 100)}%`) }); const { data } = await worker.recognize(files[0], { pdf: true }); displayDownloadLink(new Blob([new Uint8Array(data.pdf)], {type:'application/pdf'}), generateOutputFilename(files[0], 'searchable')); await worker.terminate(); }},
                 'pdf-to-pdfa': { title: 'PDF to PDF/A', desc: 'Convert for long-term archiving.', fileType: '.pdf', multiple: false, process: advancedToolComingSoon },
                 'pdf-to-text': { title: 'PDF to Text', desc: 'Extract plain text from your PDF.', fileType: '.pdf', multiple: false, process: async(files) => { const pdf = await pdfjsLib.getDocument({ data: await readFileAsArrayBuffer(files[0]) }).promise; let fullText = ''; for(let i=1; i <= pdf.numPages; i++) { showLoader(`Extracting text from page ${i}/${pdf.numPages}`); const page = await pdf.getPage(i); const textContent = await page.getTextContent(); fullText += textContent.items.map(item => item.str).join(' ') + '\n\n'; } displayDownloadLink(new Blob([fullText], {type: 'text/plain'}), generateOutputFilename(files[0], 'text', 'txt')); } },
                 'esign-pdf': { title: 'eSign PDF', desc: 'Sign your PDF documents.', fileType: '.pdf', multiple: false, options: () => `<label for="sig">Signature Image (PNG/JPG):</label><input type="file" id="sig" accept="image/png, image/jpeg"><br><label for="page">Page to Sign:</label><input type="number" id="page" value="1" min="1">`, process: async(files, options) => { const sigFile = document.getElementById('sig').files[0]; if (!sigFile) throw new Error("Please upload a signature image."); showLoader("Embedding signature..."); const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { ignoreEncryption: true }); const pageNum = parseInt(options.page, 10) - 1; if (isNaN(pageNum) || pageNum < 0 || pageNum >= pdfDoc.getPageCount()) throw new Error("Invalid page number."); const sigBytes = await readFileAsArrayBuffer(sigFile); const signatureImage = sigFile.type === 'image/png' ? await pdfDoc.embedPng(sigBytes) : await pdfDoc.embedJpg(sigBytes); pdfDoc.getPages()[pageNum].drawImage(signatureImage, { x: 50, y: 100, width: 150, height: signatureImage.height/signatureImage.width*150 }); displayDownloadLink(new Blob([await pdfDoc.save()], {type: 'application/pdf'}), generateOutputFilename(files[0], 'signed')); } },
                 'watermark-pdf': { title: 'Watermark PDF', desc: 'Add a text watermark.', fileType: '.pdf', multiple: false, options: () => `<label for="text">Watermark Text:</label><input type="text" id="text" value="CONFIDENTIAL">`, process: async (files, options) => { if(!options.text) throw new Error("Watermark text is required."); showLoader('Adding watermark to all pages...'); const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { ignoreEncryption: true }); const font = await pdfDoc.embedFont(StandardFonts.HelveticaBold); for(const page of pdfDoc.getPages()) { const {width, height} = page.getSize(); page.drawText(options.text, { x: width/2 - 100, y: height/2, font, size: 50, color: rgb(0,0,0), opacity: 0.15, rotate: degrees(45) }); } displayDownloadLink(new Blob([await pdfDoc.save()], {type: 'application/pdf'}), generateOutputFilename(files[0], 'watermarked')); } },
                 'repair-pdf': { title: 'Repair PDF', desc: 'Attempt to fix and recover a corrupted PDF.', fileType: '.pdf', multiple: false, process: async(files) => { showLoader('Attempting to repair...'); const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { ignoreEncryption: true, updateMetadata: false }); displayDownloadLink(new Blob([await pdfDoc.save()], { type: 'application/pdf' }), generateOutputFilename(files[0], 'repaired')); } },
                 'edit-pdf-metadata': { title: 'Edit Metadata', desc: 'Change author, title, and other metadata.', fileType: '.pdf', multiple: false, options: () => `<label for="meta-title">Title:</label><input type="text" id="meta-title"><label for="meta-author">Author:</label><input type="text" id="meta-author"><label for="meta-subject">Subject:</label><input type="text" id="meta-subject"><label for="meta-producer">Producer:</label><input type="text" id="meta-producer">`, process: async (files, options) => { showLoader('Updating metadata...'); const pdfDoc = await PDFDocument.load(await readFileAsArrayBuffer(files[0]), { ignoreEncryption: true }); if (options['meta-title']) pdfDoc.setTitle(options['meta-title']); if (options['meta-author']) pdfDoc.setAuthor(options['meta-author']); if (options['meta-subject']) pdfDoc.setSubject(options['meta-subject']); if (options['meta-producer']) pdfDoc.setProducer(options['meta-producer']); displayDownloadLink(new Blob([await pdfDoc.save()], {type: 'application/pdf'}), generateOutputFilename(files[0], 'metadata_edited')); } },
             };
             
             const init = () => {
                const grid = document.getElementById('tools-grid');
                grid.innerHTML = '';
                const toolOrder = [
                    'pdf-to-excel', 'excel-to-pdf', 'word-to-pdf', 'pdf-to-word', 
                    'pdf-to-powerpoint', 'powerpoint-to-pdf', 'pdf-to-jpg', 'jpg-to-pdf', 
                    'html-to-pdf', 'pdf-to-text', 'add-page-numbers', 'delete-pdf-pages', 'edit-pdf'
                ];
                const remainingTools = Object.keys(toolImplementations).filter(key => !toolOrder.includes(key));
                const finalOrder = toolOrder.concat(remainingTools);

                finalOrder.forEach(key => {
                    const tool = toolImplementations[key];
                    if (!tool) return;
                    const card = document.createElement('div');
                    card.className = 'tool-card reveal';
                    card.dataset.toolKey = key;
                    const defaultIcon = `<svg viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><g transform="translate(20, 0)"><path d="M12 4 H36 L48 16 V52 C48 54.2 46.2 56 44 56 H12 C9.8 56 8 54.2 8 52 V8 C8 5.8 9.8 4 12 4 Z" fill="#aaa" filter="drop-shadow(3px 3px 2px rgba(0,0,0,0.2))"/></g></svg>`;
                    card.innerHTML = `<div class="icon"><img src="icon/${key}.png" alt="${tool.title}" style="width: 100%; height: 100%;" onerror="this.onerror=null; this.parentNode.innerHTML = \`${defaultIcon.replace(/"/g, "&quot;")}\`"></div><h3>${tool.title}</h3><p>${tool.desc}</p>`;
                    grid.appendChild(card);
                });
                
                const observer = new IntersectionObserver((e)=>e.forEach(i=>{if(i.isIntersecting)i.target.classList.add('active')}),{threshold:.1});
                document.querySelectorAll('.reveal').forEach(el=>observer.observe(el));
                setupEventListeners();
                hideLoader();
             };

             const setupEventListeners = () => {
                document.body.addEventListener('click', (e) => {
                    const toolCard=e.target.closest('.tool-card'); if(toolCard)return openToolModal(toolCard.dataset.toolKey);
                    const footerLink=e.target.closest('.footer-tool-link'); if(footerLink){e.preventDefault();return openToolModal(footerLink.dataset.tool)}
                    const staticLink = e.target.closest('.nav-link-about, .nav-link-contact, .nav-link-privacy, .nav-link-terms');
                    if(staticLink){
                       e.preventDefault();
                       if (e.target.closest('.nav-link-about')) return openStaticModal('about');
                       if (e.target.closest('.nav-link-contact')) return openStaticModal('contact');
                       if (e.target.closest('.nav-link-privacy')) return openStaticModal('privacy');
                       if (e.target.closest('.nav-link-terms')) return openStaticModal('terms');
                    }
                    if(e.target.closest('.modal-close-btn')||e.target.closest('.close-modal-link')||e.target.matches('.nav-link-home, .nav-link-tools'))return closeAllModals();
                    if(e.target.classList.contains('remove-file')){selectedFiles.splice(parseInt(e.target.dataset.index,10),1);updateFileListUI()}
                });
                document.getElementById('search-bar').addEventListener('input',(e) => {const t=e.target.value.toLowerCase();let found=!1;document.querySelectorAll('.tool-card').forEach(card=>{const isMatch=card.textContent.toLowerCase().includes(t);card.style.display=isMatch?'flex':'none';if(isMatch)found=true;});document.getElementById('no-results-message').style.display=found?'none':'block';});
                const dropArea = document.getElementById('drop-area'); dropArea.addEventListener('click',()=>document.getElementById('file-input').click()); document.getElementById('file-input').addEventListener('change',(e)=>handleFiles(e.target.files));
                ['dragenter','dragover','dragleave','drop'].forEach(eName=>dropArea.addEventListener(eName,e=>{e.preventDefault();e.stopPropagation()}));
                ['dragenter','dragover'].forEach(eName=>dropArea.addEventListener(eName,()=>dropArea.classList.add('dragover')));
                ['dragleave','drop'].forEach(eName=>dropArea.addEventListener(eName,()=>dropArea.classList.remove('dragover')));
                dropArea.addEventListener('drop',(e)=>handleFiles(e.dataTransfer.files)); processBtn.addEventListener('click',processFiles);
                window.addEventListener('scroll',()=>document.querySelector('.header').classList.toggle('scrolled',window.scrollY>50)); document.querySelector('.hamburger').addEventListener('click',function(){this.classList.toggle('active'),document.querySelector('.mobile-nav').classList.toggle('active')});
                document.getElementById('support-fab').addEventListener('click',()=>document.getElementById('ai-chat-modal').classList.toggle('hidden')); document.getElementById('close-chat-btn').addEventListener('click',()=>document.getElementById('ai-chat-modal').classList.toggle('hidden'));
                document.getElementById('chat-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const chatInput = document.getElementById('chat-input'); const userText = chatInput.value.trim(); if(!userText) return;
                    const messagesContainer = document.getElementById('chat-messages-container');
                    const addMessage = (text, sender) => { const msgDiv = document.createElement('div'); msgDiv.className = `chat-message ${sender}-message`; msgDiv.textContent = text; messagesContainer.appendChild(msgDiv); messagesContainer.scrollTop = messagesContainer.scrollHeight; };
                    addMessage(userText, 'user'); chatInput.value = '';
                    setTimeout(() => {
                        const getReply = (msg) => {
                            const lcMsg = msg.toLowerCase();
                            for (const res of document.querySelectorAll('#ai-chat-responses > div')) {
                                const keywords = (res.dataset.keywords || '').split(',');
                                if (keywords.some(kw => kw.trim() && lcMsg.includes(kw.trim()))) return res.textContent;
                            }
                            return document.querySelector('#ai-chat-responses > div[data-keywords="default"]').textContent;
                        };
                        addMessage(getReply(userText), 'ai');
                    }, 800);
                });
                document.getElementById('prev-page-btn').addEventListener('click', goToPrevPage);
                document.getElementById('next-page-btn').addEventListener('click', goToNextPage);
             };
             const openModal = (modal) => { modal.style.display = 'block'; document.body.classList.add('modal-open'); };
             const openToolModal = (toolKey) => {
                 const tool = toolImplementations[toolKey]; if (!tool) return; resetToolModal();
                 toolModal.querySelector('.modal-tool-title').textContent = tool.title;
                 [toolModal, staticModal].forEach(m => m.querySelector('.logo').innerHTML = mainPageHeader.innerHTML);
                 const articleSource = document.getElementById(`article-${toolKey}`);
                 toolModal.querySelector('#tool-article-container').innerHTML = articleSource ? articleSource.innerHTML : `<h4>About the ${tool.title} Tool</h4><p>This tool is fast, secure, and operates entirely in your browser.</p>`;
                 toolModal.querySelector('#file-input').accept = tool.fileType || ''; 
                 toolModal.querySelector('#file-input').multiple = !!tool.multiple;
                 if(tool.options) toolModal.querySelector('#tool-options').innerHTML = tool.options();
                 document.getElementById('editor-pagination').style.display = 'none';

                 if (tool.isVisualDeleter) {
                     processBtn.style.display = 'none';
                     const processBtnDel = document.getElementById('process-selection-btn');
                     const toggleBtn = document.getElementById('action-toggle-btn');
                     const menu = document.getElementById('action-menu');
                     const deleteIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>`;
                     const saveIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>`;
                     
                     processBtnDel.innerHTML = deleteIconSVG;
                     processBtnDel.className = 'delete-mode';
                     toggleBtn.className = 'delete-mode';
                     
                     toggleBtn.onclick = () => menu.classList.toggle('hidden');
                     
                     menu.querySelectorAll('li').forEach(item => {
                         item.onclick = () => {
                             currentDeleteMode = item.dataset.action;
                             if (currentDeleteMode === 'save') {
                                 processBtnDel.innerHTML = saveIconSVG;
                                 processBtnDel.className = 'save-mode';
                                 toggleBtn.className = 'save-mode';
                             } else {
                                 processBtnDel.innerHTML = deleteIconSVG;
                                 processBtnDel.className = 'delete-mode';
                                 toggleBtn.className = 'delete-mode';
                             }
                             menu.classList.add('hidden');
                         };
                     });
                     
                 } else if (tool.isEditor) {
                    processBtn.style.display = 'none';
                    if (!editorInstance) editorInstance = setupPdfEditor();
                 }
                 toolModal.dataset.activeTool = toolKey; openModal(toolModal);
             };
             const openStaticModal = (pageKey) => {
                 const pages = {
                    about: { title: "About All Tool PDF", content: "<h3>Our Mission: Secure & Simple Document Management</h3><p>We believe that powerful PDF tools should be accessible to everyone, for free. In a digital world where data privacy is paramount, we saw a need for a reliable set of tools that don't compromise your security. Our core principle is <strong>client-side processing</strong>, which means your files are never uploaded to our servers. All operations—merging, splitting, converting, and protecting—happen securely within your own browser, giving you complete privacy and peace of mind.</p><p>This platform was built for students, professionals, and anyone who needs to manage documents efficiently without the cost of expensive software or the security risks of other online tools. Our suite is designed for maximum efficiency and ease of use. No software to install, no subscriptions—just the tools you need, right when you need them.</p>" },
                    contact: { title: "Contact Us", content: `<h3>Get in Touch</h3><p>Please fill out the form below to send us a message. Your input helps us improve our service for everyone.</p><form id="contact-form" style="display: flex; flex-direction: column; gap: 15px;"><input type="text" id="contact-name" placeholder="Your Name" required style="padding: 10px; border-radius: 4px; border: 1px solid var(--border-color);"><input type="email" id="contact-email" placeholder="Your Email" required style="padding: 10px; border-radius: 4px; border: 1px solid var(--border-color);"><input type="text" id="contact-subject" placeholder="Subject" required style="padding: 10px; border-radius: 4px; border: 1px solid var(--border-color);"><textarea id="contact-comment" placeholder="Your Comment" rows="5" required style="padding: 10px; border-radius: 4px; border: 1px solid var(--border-color); font-family: inherit;"></textarea><button type="submit" style="padding: 15px; background-color: var(--primary-red); color: white; border: none; border-radius: 8px; font-size: 1.1rem; cursor: pointer;">Send Message</button></form><p style="margin-top: 20px;">Alternatively, you can email us directly at: <strong><a href="mailto:alltoolpdf@gmail.com">alltoolpdf@gmail.com</a></strong></p>` },
                    privacy: { title: "Privacy Policy", content: "<h3>1. Core Privacy Principle: No File Uploads</h3><p>Our website is engineered to operate entirely on the <strong>client-side</strong> (i.e., in your web browser). When you use our tools to process a PDF or any other file, the file is <strong>NEVER</strong> uploaded to our servers or any third-party servers. All processing happens locally on your own computer. Your files do not leave your device, ensuring complete privacy and security.</p><h3>2. Information We Do Not Collect</h3><p>Because your files are not uploaded, we do not and cannot see, collect, or store:</p><ul><li>The content of your files.</li><li>The names of your files.</li><li>Any personal data contained within your files.</li><li>Any metadata associated with your files.</li></ul><h3>3. Anonymous Analytics</h3><p>We may collect anonymous, aggregated usage data to understand how users interact with our website (e.g., which tools are most popular). This data helps us improve our services and contains no personally identifiable information. We do not track individual users or their specific activities.</p>" },
                    terms: { title: "Terms and Conditions", content: `<h3>1. Acceptance of Terms</h3><p>By accessing and using this website, you accept and agree to be bound by the terms and provision of this agreement. If you do not agree to abide by these, you should not use this service.</p><h3>2. Use of Service</h3><p>The Service is provided to you for free for personal and reasonable business use. You agree not to use the Service for any illegal or unauthorized purpose.</p><h3>3. Disclaimer of Warranty</h3><p>The Service is provided "AS IS" and "AS AVAILABLE" without warranties of any kind, whether express or implied. All Tool PDF does not warrant that the tools will function uninterrupted, be secure, or that any errors will be corrected.</p><h3>4. Limitation of Liability</h3><p>In no event shall All Tool PDF be liable for any indirect, incidental, special, or consequential damages resulting from your use of the Service, as all processing is done locally on the user's computer.</p><h3>5. Changes to Terms</h3><p>We reserve the right to modify these terms from time to time at our sole discretion. Therefore, you should review this page periodically.</p>`}
                 };
                 staticModal.querySelector('#static-modal-title').textContent = pages[pageKey].title; staticModal.querySelector('#static-modal-body').innerHTML = pages[pageKey].content;
                 openModal(staticModal);
                 if (pageKey === 'contact') document.getElementById('contact-form').addEventListener('submit', function(e) {e.preventDefault();window.location.href = `mailto:alltoolpdf@gmail.com?subject=${encodeURIComponent(document.getElementById('contact-subject').value)}&body=${encodeURIComponent('Name: ' + document.getElementById('contact-name').value + '\nEmail: ' + document.getElementById('contact-email').value + '\n\nMessage:\n' + document.getElementById('contact-comment').value)}`;});
             };
             const closeAllModals = () => { document.querySelectorAll('.modal').forEach(m => m.style.display = 'none'); document.body.classList.remove('modal-open'); const mobileNav = document.querySelector('.mobile-nav'); if (mobileNav.classList.contains('active')) { mobileNav.classList.remove('active'); document.querySelector('.hamburger').classList.remove('active'); }};
             const resetToolModal = () => {
                 selectedFiles = [];
                 outputArea.innerHTML = '';
                 toolModal.querySelector('#file-list').innerHTML = '';
                 toolModal.querySelector('#tool-options').innerHTML = '';
                 processBtn.disabled = true;
                 processBtn.style.display = 'block';
                 processBtn.textContent = 'Convert';
                 document.getElementById('file-input').value = '';
                 document.getElementById('drop-area').style.display = 'block';
                 editorContainer.style.display = 'none';
                 deletePagesViewer.style.display = 'none';
                 currentPdfDoc = null;
                 currentPageNum = 1;
                 allPageEdits.clear();
                 currentPdfForDelete = null;
                 mainViewZoom = 1.0;
                 activePageNum = 1;
                 originalFileBuffer = null;
                 currentFileBuffer = null;
                 currentDeleteMode = 'delete';
             };
         
             const renderPage = async (pageNum) => {
                 if (!currentPdfDoc || pageNum < 1 || pageNum > currentPdfDoc.numPages) return;
                 showLoader(`Loading page ${pageNum}...`);
                 const page = await currentPdfDoc.getPage(pageNum);
                 const viewport = page.getViewport({ scale: 1.5 });
                 const canvas = document.getElementById('pdf-canvas');
                 const ctx = canvas.getContext('2d');
                 canvas.height = viewport.height;
                 canvas.width = viewport.width;
                 await page.render({ canvasContext: ctx, viewport }).promise;
                 
                 editorInstance.setInitialBackground();
                 editorInstance.setDrawingActions(allPageEdits.get(pageNum) || []);
                 editorInstance.redraw();
                 
                 const pageIndicator = document.getElementById('page-indicator');
                 pageIndicator.textContent = `Page ${pageNum} / ${currentPdfDoc.numPages}`;
                 document.getElementById('prev-page-btn').disabled = pageNum === 1;
                 document.getElementById('next-page-btn').disabled = pageNum === currentPdfDoc.numPages;
                 hideLoader();
             };
         
             const saveCurrentPageEdits = () => {
                 if(editorInstance) {
                     editorInstance.finalizeText();
                     const edits = editorInstance.getDrawingActions();
                     if (edits.length > 0) {
                         allPageEdits.set(currentPageNum, [...edits]);
                     } else {
                         allPageEdits.delete(currentPageNum);
                     }
                 }
             };
         
             const goToPrevPage = () => {
                 if (currentPageNum > 1) {
                     saveCurrentPageEdits();
                     currentPageNum--;
                     renderPage(currentPageNum);
                 }
             };
         
             const goToNextPage = () => {
                 if (currentPdfDoc && currentPageNum < currentPdfDoc.numPages) {
                     saveCurrentPageEdits();
                     currentPageNum++;
                     renderPage(currentPageNum);
                 }
             };
            
             const renderMainPage = async (pageNum, scale = 1.0) => {
                if (!currentPdfForDelete || pageNum < 1 || pageNum > currentPdfForDelete.numPages) return;
                
                const canvas = document.getElementById('main-viewer-canvas');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0,0, canvas.width, canvas.height);

                showLoader(`Loading page ${pageNum}...`);
                const page = await currentPdfForDelete.getPage(pageNum);
                const viewport = page.getViewport({ scale });
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                await page.render({ canvasContext: ctx, viewport }).promise;
                hideLoader();
                
                document.querySelectorAll('.thumbnail-item').forEach(item => item.classList.remove('active'));
                const activeThumb = document.querySelector(`.thumbnail-item[data-page-number='${pageNum}']`);
                if(activeThumb) activeThumb.classList.add('active');

                activePageNum = pageNum;
             };

             const renderAllThumbnails = async () => {
                if (!currentPdfForDelete) return;
                const sidebar = document.getElementById('page-thumbnails-sidebar');
                sidebar.innerHTML = '';
                showLoader(`Loading ${currentPdfForDelete.numPages} thumbnails...`);

                const pagesToRender = Array.from({ length: currentPdfForDelete.numPages }, (_, i) => i + 1);

                for (const pageNum of pagesToRender) {
                    const page = await currentPdfForDelete.getPage(pageNum);
                    const viewport = page.getViewport({ scale: 0.2 });
                    
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'thumbnail-item';
                    itemDiv.dataset.pageNumber = pageNum;

                    const canvas = document.createElement('canvas');
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;
                    
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.dataset.pageIndex = pageNum - 1;

                    const pageNumLabel = document.createElement('div');
                    pageNumLabel.className = 'page-number';
                    pageNumLabel.textContent = `Page ${pageNum}`;

                    itemDiv.appendChild(checkbox);
                    itemDiv.appendChild(canvas);
                    itemDiv.appendChild(pageNumLabel);
                    sidebar.appendChild(itemDiv);

                    await page.render({ canvasContext: canvas.getContext('2d'), viewport }).promise;
                    
                    itemDiv.addEventListener('click', (e) => {
                        if (e.target.type === 'checkbox') return;
                        renderMainPage(pageNum, mainViewZoom);
                    });
                }
                hideLoader();
            };
         
             const handleFiles = async (files) => {
                 const toolKey = toolModal.dataset.activeTool;
                 const tool = toolImplementations[toolKey];
                 selectedFiles = tool.multiple ? [...selectedFiles, ...Array.from(files)] : [files[0]];
                 
                 if (tool.isVisualDeleter) {
                    showLoader('Loading PDF...');
                    document.getElementById('drop-area').style.display = 'none';
                    try {
                        originalFileBuffer = await readFileAsArrayBuffer(selectedFiles[0]);
                        currentFileBuffer = originalFileBuffer;
                        currentPdfForDelete = await pdfjsLib.getDocument({ data: originalFileBuffer }).promise;
                        
                        deletePagesViewer.style.display = 'flex';
                        document.getElementById('pdf-file-name').textContent = selectedFiles[0].name;

                        await renderAllThumbnails();
                        await renderMainPage(1, 1.0);

                    } catch (e) {
                        showError("Could not load PDF. It may be corrupted or password-protected. " + e.message);
                        resetToolModal();
                    } finally {
                        hideLoader();
                    }
                 } else if (tool.isEditor) {
                    showLoader('Loading Editor...');
                    document.getElementById('drop-area').style.display = 'none';
                    try {
                        const pdfData = await readFileAsArrayBuffer(selectedFiles[0]);
                        currentPdfDoc = await pdfjsLib.getDocument({ data: pdfData }).promise;
                        currentPageNum = 1;
                        allPageEdits.clear();
         
                        editorContainer.style.display = 'flex';
                        processBtn.textContent = 'Save & Download';
                        processBtn.disabled = false;
                        processBtn.style.display = 'block';
                        
                        document.getElementById('editor-pagination').style.display = currentPdfDoc.numPages > 1 ? 'flex' : 'none';
                        
                        if (!editorInstance) editorInstance = setupPdfEditor();
                        await renderPage(1);
                        editorInstance.updateToolbarState();

                    } catch(e) {
                         showError("Could not load PDF. It may be corrupted or password-protected.");
                         resetToolModal();
                    } finally {
                         hideLoader();
                    }
                 } else {
                    updateFileListUI();
                 }
             };
         
             const updateFileListUI = () => { const fileListContainer = document.getElementById('file-list'); fileListContainer.innerHTML = ''; selectedFiles.forEach((file, index) => { const item = document.createElement('div'); item.className = 'file-item'; item.innerHTML = `<span>${file.name}</span><button class="remove-file" data-index="${index}">&times;</button>`; fileListContainer.appendChild(item); }); processBtn.disabled = selectedFiles.length === 0; };
             
             async function processFiles() {
                 const toolKey = toolModal.dataset.activeTool;
                 const tool = toolImplementations[toolKey];
                 
                 if (tool.isEditor) {
                     showLoader('Saving PDF...');
                     saveCurrentPageEdits();
         
                     const existingPdfBytes = await readFileAsArrayBuffer(selectedFiles[0]);
                     const pdfDoc = await PDFDocument.load(existingPdfBytes);
                     
                     for (const [pageNum, edits] of allPageEdits.entries()) {
                         if (edits.length === 0) continue;
                         showLoader(`Applying edits to page ${pageNum}...`);
                         const pdfPage = pdfDoc.getPages()[pageNum - 1];
                         
                         const { width, height } = pdfPage.getSize();
                         const scale = 1.5;
                         
                         const tempCanvas = document.createElement('canvas');
                         tempCanvas.width = width * scale;
                         tempCanvas.height = height * scale;
                         const tempCtx = tempCanvas.getContext('2d');
                         
                         const originalPage = await currentPdfDoc.getPage(pageNum);
                         await originalPage.render({ canvasContext: tempCtx, viewport: originalPage.getViewport({ scale }) }).promise;

                         edits.forEach(action => {
                             Object.assign(tempCtx, { fillStyle: action.color, strokeStyle: action.color, lineWidth: action.size, lineCap: 'round', lineJoin: 'round' });
                             if(action.type === 'path'){
                                tempCtx.beginPath();
                                tempCtx.moveTo(action.points[0].x, action.points[0].y);
                                action.points.slice(1).forEach(p => tempCtx.lineTo(p.x, p.y));
                                tempCtx.stroke();
                             } else if(action.type === 'text') {
                                tempCtx.font = `${action.italic ? 'italic ' : ''}${action.bold ? 'bold ' : ''}${action.size}px ${action.font}`;
                                tempCtx.textAlign = 'left'; 
                                tempCtx.textBaseline = 'top'; 
                                tempCtx.fillText(action.text, action.x, action.y);
                                if (action.underline) {
                                    const textWidth = tempCtx.measureText(action.text).width;
                                    Object.assign(tempCtx, {lineWidth: Math.max(1, Math.floor(action.size / 15)) });
                                    tempCtx.beginPath();
                                    tempCtx.moveTo(action.x, action.y + parseInt(action.size, 10) + 2); 
                                    tempCtx.lineTo(action.x + textWidth, action.y + parseInt(action.size, 10) + 2);
                                    tempCtx.stroke();
                                }
                             } else if (['line','rectangle','circle'].includes(action.type)) {
                                 tempCtx.beginPath();
                                 if (action.type === 'line') { tempCtx.moveTo(action.startX, action.startY); tempCtx.lineTo(action.endX, action.endY); } 
                                 else if (action.type === 'rectangle') { tempCtx.rect(action.startX, startY, action.endX - action.startX, action.endY - action.startY); } 
                                 else if (action.type === 'circle') { 
                                     const radiusX = Math.abs(action.endX - action.startX) / 2, radiusY = Math.abs(action.endY - startY) / 2;
                                     const centerX = action.startX + (action.endX - startX) / 2, centerY = startY + (y - startY)/2;
                                     tempCtx.ellipse(centerX, centerY, radiusX, radiusY, 0, 0, 2 * Math.PI); 
                                 }
                                 action.fill ? tempCtx.fill() : tempCtx.stroke();
                             }
                         });
                         
                         const dataUrl = tempCanvas.toDataURL('image/png');
                         const pngImage = await pdfDoc.embedPng(dataUrl);
                         pdfPage.drawImage(pngImage, { x: 0, y: 0, width: pdfPage.getWidth(), height: pdfPage.getHeight() });
                     }
         
                     outputArea.innerHTML = '';
                     displayDownloadLink(new Blob([await pdfDoc.save()], { type: 'application/pdf' }), generateOutputFilename(selectedFiles[0], 'edited'));
                     processBtn.style.display = 'none';
                     editorContainer.style.display = 'none';
                     hideLoader();
                     return;
                 }
         
                 if (tool.process) {
                     try {
                         showLoader(); 
                         document.getElementById('drop-area').style.display = 'none';
                         outputArea.innerHTML = '';
                         const options = {};
                         toolModal.querySelectorAll('#tool-options input, #tool-options select').forEach(i => {
                             const inputEl = document.getElementById(i.id);
                             if (inputEl && (inputEl.type === 'file' || inputEl.type === 'radio')) return; 
                             options[i.id] = i.value;
                         });
                         await tool.process(selectedFiles, options);
                         processBtn.style.display = 'none';
                     } catch (err) {
                         showError(err.message || 'An unexpected error occurred.');
                         document.getElementById('drop-area').style.display = 'block';
                     } finally {
                        hideLoader();
                     }
                 }
             }

            document.getElementById('zoom-in-btn').addEventListener('click', () => {
                if (!currentPdfForDelete) return;
                mainViewZoom = Math.min(3.0, mainViewZoom + 0.25);
                document.getElementById('zoom-level').textContent = `${Math.round(mainViewZoom * 100)}%`;
                renderMainPage(activePageNum, mainViewZoom);
            });

            document.getElementById('zoom-out-btn').addEventListener('click', () => {
                if (!currentPdfForDelete) return;
                mainViewZoom = Math.max(0.25, mainViewZoom - 0.25);
                document.getElementById('zoom-level').textContent = `${Math.round(mainViewZoom * 100)}%`;
                renderMainPage(activePageNum, mainViewZoom);
            });

            document.getElementById('process-selection-btn').addEventListener('click', async () => {
                if (!currentPdfForDelete) return;
                const checkedBoxes = Array.from(document.querySelectorAll('#page-thumbnails-sidebar input[type="checkbox"]:checked'));
                if (checkedBoxes.length === 0) return alert('Please select pages to process.');

                showLoader('Processing pages...');
                try {
                    const allPageIndices = Array.from({ length: currentPdfForDelete.numPages }, (_, i) => i);
                    const checkedIndices = checkedBoxes.map(cb => parseInt(cb.dataset.pageIndex, 10));
                    let pagesToDelete;

                    if (currentDeleteMode === 'delete') {
                        if (checkedIndices.length === allPageIndices.length) {
                            hideLoader();
                            return alert("You cannot delete all pages of the document.");
                        }
                        pagesToDelete = checkedIndices;
                    } else {
                        pagesToDelete = allPageIndices.filter(index => !checkedIndices.includes(index));
                    }
                    
                    const pdfDoc = await PDFDocument.load(currentFileBuffer);
                    pagesToDelete.sort((a, b) => b - a).forEach(index => pdfDoc.removePage(index));

                    const pdfBytes = await pdfDoc.save();
                    currentFileBuffer = pdfBytes.buffer;
                    
                    currentPdfForDelete = await pdfjsLib.getDocument({ data: pdfBytes }).promise;
                    await renderAllThumbnails();
                    
                    activePageNum = 1;
                    mainViewZoom = 1.0;
                    document.getElementById('zoom-level').textContent = '100%';
                    await renderMainPage(activePageNum, mainViewZoom);
                } catch (err) { showError('Failed to process pages: ' + err.message); } finally { hideLoader(); }
            });

            document.getElementById('download-deleted-btn').addEventListener('click', () => {
                if (!currentFileBuffer || currentFileBuffer.byteLength === 0) return showError('No file to download. Please process a file first.');
                const blob = new Blob([currentFileBuffer], { type: 'application/pdf' });
                const fileName = generateOutputFilename(selectedFiles[0], 'modified');
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = fileName;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });

             init();
           });
      </script>
   </body>
</html>